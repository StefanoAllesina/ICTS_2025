[
  {
    "objectID": "ch3.html",
    "href": "ch3.html",
    "title": "GLV and experimental data",
    "section": "",
    "text": "For this exploration, we are going to consider a popular type of experiment in which different combinations of species, taken from a species’ pool are co-cultured.\nThese experiments are routinely conducted with plants (for example, to test the relationship between productivity and biodiversity), bacteria (for example, to determine rules of thumb for coexistence), protozoans, etc.\nIn many cases, only the final outcome (i.e., the density of the populations at the end of each experiment) is available/recorded.\nTypically, the pool of species to experiment with contains only species that can grow in isolation.\nIf one has access to a pool of \\(n\\) species, testing all the possible \\(2^n-1\\) combinations obtained by including/excluding each of the species rapidly becomes impractical as \\(n\\) grows. Therefore, all the possible combinations are tested only when \\(n\\) is small, while a small fraction of the possible communities is typically available when \\(n\\) is large.\n\n\n\nFor our explorations, we are going to use recent data from Ishizawa and colleagues, which you can find here:\nH. Ishizawa, Y. Tashiro, D. Inoue, M. Ike, H. Futamata. Learning beyond-pairwise interactions enables the bottom–up prediction of microbial community structure PNAS 121 (7) e2312396121 (2024).\nThe Authors inoculated duckweed (lemna minor) with synthetic bacterial communities formed by all possible combinations of seven strains. To this end, they cultured the infected duckweed in flasks for 10 days. At the end of the experiment, they plated the communities on agar plates containing antibiotics that would allow the growth only of a particular strain. In this way, they were able to measure the final density of each of the seven strains in each of the \\(2^7 - 1 = 127\\) possible communities, and conducted each experiment in replicate. The full data set reports the outcome of 692 separate experiments!\nMore modestly, here we are going to focus on a smaller pool of three strains taken from the seven available. We therefore have \\(7\\) possible communities, ranging from a single strain growing in isolation to the three strains growing together. For example, a few of the measurements are:\n\n\n\nDW067\nDW102\nDW145\ncommunity\nreplicate\n\n\n\n\n\n\n0.8\n1\n1\n\n\n\n\n0.812\n1\n2\n\n\n\n0.529\n\n2\n1\n\n\n\n0.356\n\n2\n2\n\n\n\n0.703\n0.909\n3\n1\n\n\n\n0.395\n0.661\n3\n2\n\n\n0.386\n0.602\n0.563\n4\n1\n\n\n0.379\n0.774\n0.293\n4\n2\n\n\n\nWe can therefore associated each measurement with a) the strain being measured, \\(i\\); b) the community in which \\(i\\) was grown, \\(k\\); and c) the (biological) replicate experiment, \\(r\\).\n\n\n\nThe simplest model we can write for this type of data is one in which the outcomes of replicate experiments are independent samples from a distribution:\n\\[\n\\tilde{x}^{(k,r)}_i \\sim Q_i\\left(x^{(k)}_i, \\gamma_i^{(k)}\\right)\n\\] where \\(\\tilde{x}_i^{(k, r)}\\) is the observed density of population \\(i\\) for the \\(r\\) replicate in which population \\(i\\) is grown in community \\(k\\). The value \\(x_i^{(k)}\\) represents the true mean of the distribution (i.e., the average if we were to conduct many replicates—hence it does not depend on \\(r\\)), and \\(\\gamma_i^{(k)}\\) is a parameter (or several parameters) controlling the shape of the distribution \\(Q_i\\).\nImplicitly, we are making a very strong assumption: if we observe the community \\(k\\), it is always found around \\(x^{(k)}\\)—i.e., we cannot have true multistability, in which, depending on initial conditions, we end up with different outcomes in which all populations are present (we can still have that, depending on initial condition, the system ends up at different points/attractor, as long as they have different compositions).\nThis model requires estimating all the \\(x_i^{(k)}\\) and \\(\\gamma_i^{(k)}\\), and is therefore not very useful. To make the model applicable to real data, we make another strong assumption:\n\\[\nx_i^{(k)} = \\alpha_i - \\sum_{j \\in k;\\, j\\neq i } \\beta_{ij} x_j^{(k)}\n\\] The interpretation is simple: if population \\(i\\) is grown by itself, it will reach the carrying capacity \\(\\alpha_i\\); if other species are co-cultured along with \\(i\\), they will change the final density of \\(i\\) according to their density (\\(x_j^{(k)}\\)) and an interaction term \\(\\beta_{ij}\\).\nWe perform some manipulations:\n\\[\n\\begin{aligned}\n\\sum_{j \\in k;\\, j\\neq i } \\beta_{ij} x_j^{(k)} + x_i^{(k)} &= \\alpha_i \\\\\n\\sum_{j \\in k;\\, j\\neq i } \\frac{\\beta_{ij}}{\\alpha_i} x_j^{(k)} + \\frac{1}{\\alpha_i} x_i^{(k)} &= 1 \\\\\n\\sum_{j \\in k;\\, j\\neq i } B_{ij} x_j^{(k)} + B_{ii} x_i^{(k)} &= 1 \\\\\n\\sum_{j \\in k}B_{ij} x_j^{(k)} &=1\\\\\n\\left(B^{(k, k)} x^{(k)}\\right)_i &=1\\\\\nB^{(k, k)} x^{(k)} &= 1_{\\|k\\|}\n\\end{aligned}\n\\]\nBut this is exactly the structure of the equilibria for a GLV model, which we have introduced in Lecture 1.\n\n\n\nTake the model:\n\\[\n\\dot{x} = D(x \\circ r)(1_n - Bx)\n\\] with \\(r &gt; 0_n\\); compute all the feasible equilibria and collect them into a matrix \\(E\\). For example:\n$$ B =\n\\[\\begin{pmatrix}\n2 & -3 & 3\\\\\n-2 & 7 & -3\\\\\n2 & -2 & 2\n\\end{pmatrix} \\quad\\]\nE =\n\\[\\begin{pmatrix}\n\\frac{1}{2} & 0 & 0\\\\\n0 & \\frac{1}{7} & 0\\\\\n0 & 0 & \\frac{1}{2}\\\\\n\\frac{5}{4} &\\frac{1}{2} & 0\\\\\n0 & \\frac{5}{8} & \\frac{9}{8}\\\\\n\\frac{1}{2} & \\frac{1}{2} & \\frac{1}{2}\n\\end{pmatrix}\\]\n$$\nwhere each row contains a feasible equilibrium (if it exists) corresponding to a given composition.\nConsider the matrix:\n\\[\n1_m 1_n^T - E B^T = \\begin{pmatrix}\n\\color{red} 0 & 2 & 0\\\\\n\\frac{10}{7} & \\color{red} 0 & \\frac{9}{7}\\\\\n-\\frac{1}{2} &\\frac{5}{2} &\\color{red}0\\\\\n\\color{red} 0 & \\color{red} 0 & -\\frac{1}{2}\\\\\n-\\frac{1}{2} & \\color{red} 0 & \\color{red} 0\\\\\n\\color{red} 0 &\\color{red} 0 &\\color{red} 0  \n\\end{pmatrix}\n\\]\nFor each row, we find \\(0\\) for the corresponding population at equilibrium (in red), and the remaining values express \\((1_n - B x^{(k)})_j\\), which has the same sign as the invasion growth rates for population \\(j\\), when \\(r &gt; 0_n\\). Hence, a saturated equilibrium will correspond to a row with nonpositive values (e.g., the community \\(k=\\{1,2\\}\\) is saturated, because population 3 cannot invade when rare).\nNext, call \\(E_i\\) the submatrix obtained selecting only rows for which \\(x_i^{(k)} &gt; 0\\). For example, for population 1:\n\\[\nE_1 = \\begin{pmatrix}\n\\frac{1}{2} & 0 & 0\\\\\n\\frac{5}{4} &\\frac{1}{2} & 0\\\\\n\\frac{1}{2} & \\frac{1}{2} & \\frac{1}{2}\n\\end{pmatrix}\n\\] We have that:\n\\[\nE_i B_i = 1_l\n\\]\nWhere \\(B_i\\) is the \\(i^\\text{th}\\) row of \\(B\\), and \\(l\\) is the number of experiments in which \\(i\\) is present:\n\\[\nE_1 B_1 = \\begin{pmatrix}\n\\frac{1}{2} & 0 & 0\\\\\n\\frac{5}{4} &\\frac{1}{2} & 0\\\\\n\\frac{1}{2} & \\frac{1}{2} & \\frac{1}{2}\n\\end{pmatrix} \\begin{pmatrix}\n2\\\\\n-3\\\\\n3\n\\end{pmatrix} = \\begin{pmatrix}\n1\\\\\n1\\\\\n1\n\\end{pmatrix}\n\\] Practically, this means that all the \\(i^\\text{th}\\) component of all the equilibria \\(x^{(k)}\\) of a GLV model belong to a hyperplane in \\(\\mathbb R^n\\) defined by \\(\\sum_{j} B_{ij} x^{(k)}_j = 1\\).\nThis also means that we can recover the values of \\(B_i\\) from the equilibria:\n\\[\nB_i = E_i^{-1}1_n\n\\]\nwhich can be computed when \\(E_i\\) is square. Otherwise, use the Moore-Penrose pseudo-inverse. For example:\n\\[\nE_2 = \\begin{pmatrix}\n0 & \\frac{1}{7} & 0\\\\\n\\frac{5}{4} &\\frac{1}{2} & 0\\\\\n0 & \\frac{5}{8} & \\frac{9}{8}\\\\\n\\frac{1}{2} & \\frac{1}{2} & \\frac{1}{2}\n\\end{pmatrix}\n\\]\n\\[\n(E_2^T E_2)^{-1}E_2^T 1_4= \\begin{pmatrix}\n-2 \\\\\n7 \\\\\n-3\n\\end{pmatrix} = B_2\n\\]\nThis also provides a naive method to get a draft of \\(B\\) when only the equilibrium values are available.\nThe method is going to return a unique solution provided that each matrix \\(E_i\\) has rank \\(n\\). In practice, this means that, for each population \\(i\\), a) \\(E_i\\) has at least \\(n\\) rows (i.e., population \\(i\\) is present at \\(n\\) distinct equilibria), and b) each species \\(j\\) is present in at least one equilibrium with \\(i\\), i.e., each pair of populations is found in at least one equilibrium.\nThis might be a tall order when \\(n\\) is large, and in the tutorial we will see how to circumvent this issue.\n\n\n\nSuppose that we have estimated the matrix \\(B\\), and that we want to determine whether a certain combination of populations can or cannot coexist. This is useful when we have sufficient data to estimate \\(B\\), but we have not carried out all the possible experiments—we want to predict the outcome of further experiments in advance.\nThen, according to our statistical model, we can take \\(B^{(k,k)}\\) for the desired community \\(k\\), and take the row sums of the inverse:\n\\[\nx^{(k)} = \\left( B^{(k,k)} \\right)^{-1} 1_{\\|k\\|}\n\\]\nIf all the components of \\(x^{(k)}\\) are positive, we assume that this will be the outcome of the experiment. If any of the components is negative, on the other hand, we conclude that the populations cannot coexist.\n\n\n\nThe paragraph above suggests a good way to score matrices in practice (i.e., when the empirically-observed matrix \\(\\tilde{E}\\) is a noisy estimate of a true matrix \\(E\\)):\n\nPropose a matrix \\(B\\)\nCompute \\(x^{(k)}\\) for each observed \\(\\tilde{x}^{(k,r)}\\)\nTry to minimize the distance between the predicted and observed\n\nNaturally, this algorithm relies on a notion of distance. The simplest choice would be to choose \\(B\\) such that the sum of squared deviations is minimized:\n\\[\nSSQ(B) = \\sum_r \\sum_k \\sum_i \\left(\\tilde{x}^{(k,r)}_i - x^{(k)}_i \\right)^2\n\\]\nWhen the values of \\(\\tilde{x}^{(k)}_i\\) vary considerably (as expected when populations interact), minimizing the SSQ will favor matrices that match closely the rows of \\(\\tilde{E}\\) containing large values, such that a 10% error on a small value of \\(\\tilde{x}^{(k)}_i\\) “counts” less than a 1% error for a large value.\nIf we want to put all rows on the same footing, we can implement a Weighted Least Squares scheme, in which\n\\[\nWLS(B) = \\sum_r \\sum_k \\sum_i \\left(\\frac{\\tilde{x}^{(k,r)}_i - x^{(k)}_i}{\\sigma^{(k)}_i} \\right)^2\n\\]\nwhere deviations are weighted by the respective standard deviation (for simplicity, we can take \\(\\sigma_i^{(k)} = \\sqrt{ \\mathbb E\\left((\\tilde{x}_i^{(k,r)})^2 \\right) - \\left( \\mathbb E\\left(\\tilde{x}_i^{(k,r)} \\right)\\right)^2}\\).\nFinally, we can have a likelihood-based approach in which we are trying to maximize the sum of log-likelihoods:\n\\[\n\\mathcal L(B) = \\sum_r \\sum_k \\sum_i \\log P\\left(\\tilde{x}^{(k,r)}_i|x^{(k)}_i, \\gamma_i^{(k)} \\right)\n\\]\nwhere \\(P(x|\\mu, \\gamma)\\) is the density of a probability distribution function whose shape is controlled by parameters \\(\\mu\\) and \\(\\gamma\\).\nIn the tutorial, we are going to experiment with all three approaches, and discuss pros and cons.\n\n\n\nThe backbone of the statistical model can be found in numerous articles, which converged to the same solution starting from different angles:\n\nXiao, Y., Angulo, M. T., Friedman, J., Waldor, M. K., Weiss, S. T., & Liu, Y.-Y. (2017). Mapping the ecological networks of microbial communities. Nature Communications, 8(1), 1–12.\nFort, H. (2018). On predicting species yields in multispecies communities: Quantifying the accuracy of the linear Lotka-Volterra generalized model. Ecological Modelling, 387, 154–162.\nMaynard, D. S., Miller, Z. R., & Allesina, S. (2020). Predicting coexistence in experimental ecological communities. Nature Ecology & Evolution, 4(1), 91–100.\nAnsari, A. F., Reddy, Y., Raut, J., & Dixit, N. M. (2021). An efficient and scalable top-down method for predicting structures of microbial communities. Nature Computational Science, 1(9), 619–628.\nDavis, J.D., Olivença, D.V., Brown, S.P. and Voit, E.O., (2022). Methods of quantifying interactions among populations using Lotka-Volterra models. Frontiers in Systems Biology, 2, p.1021897.\n\nFor the tutorial, we are going to closely follow:\n\nSkwara, A., Lemos‐Costa, P., Miller, Z.R. and Allesina, S., 2023. Modelling ecological communities when composition is manipulated experimentally. Methods in Ecology and Evolution, 14(2), pp.696-707.\n\nThe same method can be extended to provide a simple test for phylogenetic effects on competition/growth:\n\nLemos‐Costa, P., Miller, Z.R. and Allesina, S., 2024. Phylogeny structures species’ interactions in experimental ecological communities. Ecology Letters, 27(8), p.e14490."
  },
  {
    "objectID": "ch3.html#experiments-in-which-different-combinations-of-species-are-grown-together",
    "href": "ch3.html#experiments-in-which-different-combinations-of-species-are-grown-together",
    "title": "GLV and experimental data",
    "section": "",
    "text": "For this exploration, we are going to consider a popular type of experiment in which different combinations of species, taken from a species’ pool are co-cultured.\nThese experiments are routinely conducted with plants (for example, to test the relationship between productivity and biodiversity), bacteria (for example, to determine rules of thumb for coexistence), protozoans, etc.\nIn many cases, only the final outcome (i.e., the density of the populations at the end of each experiment) is available/recorded.\nTypically, the pool of species to experiment with contains only species that can grow in isolation.\nIf one has access to a pool of \\(n\\) species, testing all the possible \\(2^n-1\\) combinations obtained by including/excluding each of the species rapidly becomes impractical as \\(n\\) grows. Therefore, all the possible combinations are tested only when \\(n\\) is small, while a small fraction of the possible communities is typically available when \\(n\\) is large."
  },
  {
    "objectID": "ch3.html#example-data",
    "href": "ch3.html#example-data",
    "title": "GLV and experimental data",
    "section": "",
    "text": "For our explorations, we are going to use recent data from Ishizawa and colleagues, which you can find here:\nH. Ishizawa, Y. Tashiro, D. Inoue, M. Ike, H. Futamata. Learning beyond-pairwise interactions enables the bottom–up prediction of microbial community structure PNAS 121 (7) e2312396121 (2024).\nThe Authors inoculated duckweed (lemna minor) with synthetic bacterial communities formed by all possible combinations of seven strains. To this end, they cultured the infected duckweed in flasks for 10 days. At the end of the experiment, they plated the communities on agar plates containing antibiotics that would allow the growth only of a particular strain. In this way, they were able to measure the final density of each of the seven strains in each of the \\(2^7 - 1 = 127\\) possible communities, and conducted each experiment in replicate. The full data set reports the outcome of 692 separate experiments!\nMore modestly, here we are going to focus on a smaller pool of three strains taken from the seven available. We therefore have \\(7\\) possible communities, ranging from a single strain growing in isolation to the three strains growing together. For example, a few of the measurements are:\n\n\n\nDW067\nDW102\nDW145\ncommunity\nreplicate\n\n\n\n\n\n\n0.8\n1\n1\n\n\n\n\n0.812\n1\n2\n\n\n\n0.529\n\n2\n1\n\n\n\n0.356\n\n2\n2\n\n\n\n0.703\n0.909\n3\n1\n\n\n\n0.395\n0.661\n3\n2\n\n\n0.386\n0.602\n0.563\n4\n1\n\n\n0.379\n0.774\n0.293\n4\n2\n\n\n\nWe can therefore associated each measurement with a) the strain being measured, \\(i\\); b) the community in which \\(i\\) was grown, \\(k\\); and c) the (biological) replicate experiment, \\(r\\)."
  },
  {
    "objectID": "ch3.html#a-simple-statistical-framework",
    "href": "ch3.html#a-simple-statistical-framework",
    "title": "GLV and experimental data",
    "section": "",
    "text": "The simplest model we can write for this type of data is one in which the outcomes of replicate experiments are independent samples from a distribution:\n\\[\n\\tilde{x}^{(k,r)}_i \\sim Q_i\\left(x^{(k)}_i, \\gamma_i^{(k)}\\right)\n\\] where \\(\\tilde{x}_i^{(k, r)}\\) is the observed density of population \\(i\\) for the \\(r\\) replicate in which population \\(i\\) is grown in community \\(k\\). The value \\(x_i^{(k)}\\) represents the true mean of the distribution (i.e., the average if we were to conduct many replicates—hence it does not depend on \\(r\\)), and \\(\\gamma_i^{(k)}\\) is a parameter (or several parameters) controlling the shape of the distribution \\(Q_i\\).\nImplicitly, we are making a very strong assumption: if we observe the community \\(k\\), it is always found around \\(x^{(k)}\\)—i.e., we cannot have true multistability, in which, depending on initial conditions, we end up with different outcomes in which all populations are present (we can still have that, depending on initial condition, the system ends up at different points/attractor, as long as they have different compositions).\nThis model requires estimating all the \\(x_i^{(k)}\\) and \\(\\gamma_i^{(k)}\\), and is therefore not very useful. To make the model applicable to real data, we make another strong assumption:\n\\[\nx_i^{(k)} = \\alpha_i - \\sum_{j \\in k;\\, j\\neq i } \\beta_{ij} x_j^{(k)}\n\\] The interpretation is simple: if population \\(i\\) is grown by itself, it will reach the carrying capacity \\(\\alpha_i\\); if other species are co-cultured along with \\(i\\), they will change the final density of \\(i\\) according to their density (\\(x_j^{(k)}\\)) and an interaction term \\(\\beta_{ij}\\).\nWe perform some manipulations:\n\\[\n\\begin{aligned}\n\\sum_{j \\in k;\\, j\\neq i } \\beta_{ij} x_j^{(k)} + x_i^{(k)} &= \\alpha_i \\\\\n\\sum_{j \\in k;\\, j\\neq i } \\frac{\\beta_{ij}}{\\alpha_i} x_j^{(k)} + \\frac{1}{\\alpha_i} x_i^{(k)} &= 1 \\\\\n\\sum_{j \\in k;\\, j\\neq i } B_{ij} x_j^{(k)} + B_{ii} x_i^{(k)} &= 1 \\\\\n\\sum_{j \\in k}B_{ij} x_j^{(k)} &=1\\\\\n\\left(B^{(k, k)} x^{(k)}\\right)_i &=1\\\\\nB^{(k, k)} x^{(k)} &= 1_{\\|k\\|}\n\\end{aligned}\n\\]\nBut this is exactly the structure of the equilibria for a GLV model, which we have introduced in Lecture 1."
  },
  {
    "objectID": "ch3.html#the-structure-of-equilibria-in-glv",
    "href": "ch3.html#the-structure-of-equilibria-in-glv",
    "title": "GLV and experimental data",
    "section": "",
    "text": "Take the model:\n\\[\n\\dot{x} = D(x \\circ r)(1_n - Bx)\n\\] with \\(r &gt; 0_n\\); compute all the feasible equilibria and collect them into a matrix \\(E\\). For example:\n$$ B =\n\\[\\begin{pmatrix}\n2 & -3 & 3\\\\\n-2 & 7 & -3\\\\\n2 & -2 & 2\n\\end{pmatrix} \\quad\\]\nE =\n\\[\\begin{pmatrix}\n\\frac{1}{2} & 0 & 0\\\\\n0 & \\frac{1}{7} & 0\\\\\n0 & 0 & \\frac{1}{2}\\\\\n\\frac{5}{4} &\\frac{1}{2} & 0\\\\\n0 & \\frac{5}{8} & \\frac{9}{8}\\\\\n\\frac{1}{2} & \\frac{1}{2} & \\frac{1}{2}\n\\end{pmatrix}\\]\n$$\nwhere each row contains a feasible equilibrium (if it exists) corresponding to a given composition.\nConsider the matrix:\n\\[\n1_m 1_n^T - E B^T = \\begin{pmatrix}\n\\color{red} 0 & 2 & 0\\\\\n\\frac{10}{7} & \\color{red} 0 & \\frac{9}{7}\\\\\n-\\frac{1}{2} &\\frac{5}{2} &\\color{red}0\\\\\n\\color{red} 0 & \\color{red} 0 & -\\frac{1}{2}\\\\\n-\\frac{1}{2} & \\color{red} 0 & \\color{red} 0\\\\\n\\color{red} 0 &\\color{red} 0 &\\color{red} 0  \n\\end{pmatrix}\n\\]\nFor each row, we find \\(0\\) for the corresponding population at equilibrium (in red), and the remaining values express \\((1_n - B x^{(k)})_j\\), which has the same sign as the invasion growth rates for population \\(j\\), when \\(r &gt; 0_n\\). Hence, a saturated equilibrium will correspond to a row with nonpositive values (e.g., the community \\(k=\\{1,2\\}\\) is saturated, because population 3 cannot invade when rare).\nNext, call \\(E_i\\) the submatrix obtained selecting only rows for which \\(x_i^{(k)} &gt; 0\\). For example, for population 1:\n\\[\nE_1 = \\begin{pmatrix}\n\\frac{1}{2} & 0 & 0\\\\\n\\frac{5}{4} &\\frac{1}{2} & 0\\\\\n\\frac{1}{2} & \\frac{1}{2} & \\frac{1}{2}\n\\end{pmatrix}\n\\] We have that:\n\\[\nE_i B_i = 1_l\n\\]\nWhere \\(B_i\\) is the \\(i^\\text{th}\\) row of \\(B\\), and \\(l\\) is the number of experiments in which \\(i\\) is present:\n\\[\nE_1 B_1 = \\begin{pmatrix}\n\\frac{1}{2} & 0 & 0\\\\\n\\frac{5}{4} &\\frac{1}{2} & 0\\\\\n\\frac{1}{2} & \\frac{1}{2} & \\frac{1}{2}\n\\end{pmatrix} \\begin{pmatrix}\n2\\\\\n-3\\\\\n3\n\\end{pmatrix} = \\begin{pmatrix}\n1\\\\\n1\\\\\n1\n\\end{pmatrix}\n\\] Practically, this means that all the \\(i^\\text{th}\\) component of all the equilibria \\(x^{(k)}\\) of a GLV model belong to a hyperplane in \\(\\mathbb R^n\\) defined by \\(\\sum_{j} B_{ij} x^{(k)}_j = 1\\).\nThis also means that we can recover the values of \\(B_i\\) from the equilibria:\n\\[\nB_i = E_i^{-1}1_n\n\\]\nwhich can be computed when \\(E_i\\) is square. Otherwise, use the Moore-Penrose pseudo-inverse. For example:\n\\[\nE_2 = \\begin{pmatrix}\n0 & \\frac{1}{7} & 0\\\\\n\\frac{5}{4} &\\frac{1}{2} & 0\\\\\n0 & \\frac{5}{8} & \\frac{9}{8}\\\\\n\\frac{1}{2} & \\frac{1}{2} & \\frac{1}{2}\n\\end{pmatrix}\n\\]\n\\[\n(E_2^T E_2)^{-1}E_2^T 1_4= \\begin{pmatrix}\n-2 \\\\\n7 \\\\\n-3\n\\end{pmatrix} = B_2\n\\]\nThis also provides a naive method to get a draft of \\(B\\) when only the equilibrium values are available.\nThe method is going to return a unique solution provided that each matrix \\(E_i\\) has rank \\(n\\). In practice, this means that, for each population \\(i\\), a) \\(E_i\\) has at least \\(n\\) rows (i.e., population \\(i\\) is present at \\(n\\) distinct equilibria), and b) each species \\(j\\) is present in at least one equilibrium with \\(i\\), i.e., each pair of populations is found in at least one equilibrium.\nThis might be a tall order when \\(n\\) is large, and in the tutorial we will see how to circumvent this issue."
  },
  {
    "objectID": "ch3.html#predicting-coexistence",
    "href": "ch3.html#predicting-coexistence",
    "title": "GLV and experimental data",
    "section": "",
    "text": "Suppose that we have estimated the matrix \\(B\\), and that we want to determine whether a certain combination of populations can or cannot coexist. This is useful when we have sufficient data to estimate \\(B\\), but we have not carried out all the possible experiments—we want to predict the outcome of further experiments in advance.\nThen, according to our statistical model, we can take \\(B^{(k,k)}\\) for the desired community \\(k\\), and take the row sums of the inverse:\n\\[\nx^{(k)} = \\left( B^{(k,k)} \\right)^{-1} 1_{\\|k\\|}\n\\]\nIf all the components of \\(x^{(k)}\\) are positive, we assume that this will be the outcome of the experiment. If any of the components is negative, on the other hand, we conclude that the populations cannot coexist."
  },
  {
    "objectID": "ch3.html#scoring-matrices-b",
    "href": "ch3.html#scoring-matrices-b",
    "title": "GLV and experimental data",
    "section": "",
    "text": "The paragraph above suggests a good way to score matrices in practice (i.e., when the empirically-observed matrix \\(\\tilde{E}\\) is a noisy estimate of a true matrix \\(E\\)):\n\nPropose a matrix \\(B\\)\nCompute \\(x^{(k)}\\) for each observed \\(\\tilde{x}^{(k,r)}\\)\nTry to minimize the distance between the predicted and observed\n\nNaturally, this algorithm relies on a notion of distance. The simplest choice would be to choose \\(B\\) such that the sum of squared deviations is minimized:\n\\[\nSSQ(B) = \\sum_r \\sum_k \\sum_i \\left(\\tilde{x}^{(k,r)}_i - x^{(k)}_i \\right)^2\n\\]\nWhen the values of \\(\\tilde{x}^{(k)}_i\\) vary considerably (as expected when populations interact), minimizing the SSQ will favor matrices that match closely the rows of \\(\\tilde{E}\\) containing large values, such that a 10% error on a small value of \\(\\tilde{x}^{(k)}_i\\) “counts” less than a 1% error for a large value.\nIf we want to put all rows on the same footing, we can implement a Weighted Least Squares scheme, in which\n\\[\nWLS(B) = \\sum_r \\sum_k \\sum_i \\left(\\frac{\\tilde{x}^{(k,r)}_i - x^{(k)}_i}{\\sigma^{(k)}_i} \\right)^2\n\\]\nwhere deviations are weighted by the respective standard deviation (for simplicity, we can take \\(\\sigma_i^{(k)} = \\sqrt{ \\mathbb E\\left((\\tilde{x}_i^{(k,r)})^2 \\right) - \\left( \\mathbb E\\left(\\tilde{x}_i^{(k,r)} \\right)\\right)^2}\\).\nFinally, we can have a likelihood-based approach in which we are trying to maximize the sum of log-likelihoods:\n\\[\n\\mathcal L(B) = \\sum_r \\sum_k \\sum_i \\log P\\left(\\tilde{x}^{(k,r)}_i|x^{(k)}_i, \\gamma_i^{(k)} \\right)\n\\]\nwhere \\(P(x|\\mu, \\gamma)\\) is the density of a probability distribution function whose shape is controlled by parameters \\(\\mu\\) and \\(\\gamma\\).\nIn the tutorial, we are going to experiment with all three approaches, and discuss pros and cons."
  },
  {
    "objectID": "ch3.html#references-and-further-readings",
    "href": "ch3.html#references-and-further-readings",
    "title": "GLV and experimental data",
    "section": "",
    "text": "The backbone of the statistical model can be found in numerous articles, which converged to the same solution starting from different angles:\n\nXiao, Y., Angulo, M. T., Friedman, J., Waldor, M. K., Weiss, S. T., & Liu, Y.-Y. (2017). Mapping the ecological networks of microbial communities. Nature Communications, 8(1), 1–12.\nFort, H. (2018). On predicting species yields in multispecies communities: Quantifying the accuracy of the linear Lotka-Volterra generalized model. Ecological Modelling, 387, 154–162.\nMaynard, D. S., Miller, Z. R., & Allesina, S. (2020). Predicting coexistence in experimental ecological communities. Nature Ecology & Evolution, 4(1), 91–100.\nAnsari, A. F., Reddy, Y., Raut, J., & Dixit, N. M. (2021). An efficient and scalable top-down method for predicting structures of microbial communities. Nature Computational Science, 1(9), 619–628.\nDavis, J.D., Olivença, D.V., Brown, S.P. and Voit, E.O., (2022). Methods of quantifying interactions among populations using Lotka-Volterra models. Frontiers in Systems Biology, 2, p.1021897.\n\nFor the tutorial, we are going to closely follow:\n\nSkwara, A., Lemos‐Costa, P., Miller, Z.R. and Allesina, S., 2023. Modelling ecological communities when composition is manipulated experimentally. Methods in Ecology and Evolution, 14(2), pp.696-707.\n\nThe same method can be extended to provide a simple test for phylogenetic effects on competition/growth:\n\nLemos‐Costa, P., Miller, Z.R. and Allesina, S., 2024. Phylogeny structures species’ interactions in experimental ecological communities. Ecology Letters, 27(8), p.e14490."
  },
  {
    "objectID": "ch4.html",
    "href": "ch4.html",
    "title": "GLV and metatpopulation dynamics",
    "section": "",
    "text": "GLV and metatpopulation dynamics\nTODO\nMay R.M. 1972. Will a large complex system be stable? Nature 238:413-414\nMcCann, K.S. 2000. The diversity - stability debate. Nature 405:228-233"
  },
  {
    "objectID": "about.html",
    "href": "about.html",
    "title": "About",
    "section": "",
    "text": "These lecture notes were prepared by Stefano Allesina (sallesina@uchicago.edu) for the ICTP-ICTS Winter School on Quantitative Systems Biology, held at NCBS, Bengaluru, India.\nCall-out sections contain special material:\n\n\n\n\n\n\nMathematical review\n\n\n\n\n\nThis type of call-out contains brief reviews of important mathematical concepts.\n\n\n\n\n\n\n\n\n\nComputing in R\n\n\n\n\n\nThis type of call-out contains information about coding dynamical systems in R.\n\n\n\n\nResources\nThese are good introductions to theoretical ecology:\n\nCase, An Illustrated Guide to Theoretical Ecology, 1999\nMay and McLean, Theoretical Ecology: Principles and Applications, 2007\nGotelli, A primer of ecology, 2008\nHofbauer and Sigmund Evolutionary Games and Population Dynamics, 1998\n\n\n\nMathematical background\nFollowing the material requires basic notions in calculus, linear algebra and dynamical systems. Students should be familiar with:\n\nFunctions, exponential function, logarithm\nLimits\nDerivatives and chain rule\nIntegration of functions in one and several variables\nTaylor series\nVectors, dot product, cross product\nMatrix product, transpose, determinant, eigenvalue decomposition\nPositive and negative definiteness of a matrix\n\nThese are good websites offering a brief review of these materials, and cheat sheets reporting the main formulas:\n\nPaul’s Online Notes covering calculus I, II and III as well as dynamical systems; the cheat sheets are excellent.\nThe legendary Linear Algebra class by Gilbert Strang, who has written popular books on the subject, and taught legions of students at MIT.\nZiko Kolter has published a brief review of linear algebra concepts.\nLinear algebra in four pages by Ivan Savov.\nLinear algebra visualized by 3Blue1Brown.\nSteve Brunton’s (U. Washington) YouTube channel contains extremely well-done lectures on dynamical systems; for example, here are reviews of derivatives, Taylor series, simulating the logistic map, integrating ODEs in a computer."
  },
  {
    "objectID": "index.html",
    "href": "index.html",
    "title": "ICTS QSB 2025",
    "section": "",
    "text": "We have four lectures, plus some tutorials. We are going to concentrate on the Generalized Lotka-Volterra model—which turns 100 years old in 2026.\n\nLecture 1. The Generalized Lotka-Volterra model for \\(n\\) interacting populations.\nLecture 2. GLV with random parameters.\nLecture 3. GLV to model experimental data.\nLecture 4. GLV and metapopulation dynamics.\n\n\n\nThe GitHub repository associated with the lecture notes contains the code used to generate the lecture notes, including all the figures and simulations. Crucially, the code depends on the following R packages:\n\nlibrary(tidyverse) # plotting, data organization\nlibrary(deSolve) # integrate differential equations\n\n\n\n\n\nWe write \\(x(t)\\) for the density of population \\(x\\) at time \\(t\\). In many cases, we will write simply \\(x\\), as the dependency on time is always assumed. For discrete-time models, we write \\(x_t\\) instead. Typically, \\(x(t)\\) is measured in either \\([\\text{mass}]/[\\text{area/volume}]\\) or \\([\\text{number of individuals}]/[\\text{area/volume}]\\)\nThe density of a population typically changes in time, and the change is modulated by several parameters. Unless specified, we use Greek letters for scalars, lower-case Latin letters for vectors, and upper-case Latin letters for matrices.\nOther useful notation:\n\n\\(i\\) is the imaginary unit, such that \\(i^2 = -1\\)\n\\(0_n\\) is a vector of zeros of lenght \\(n\\)\n\\(1_n\\) is a vector of ones of lenght \\(n\\)\n\\(I\\) is the identity matrix (i.e., a matrix with \\(1_n\\) on the diagonal, and zeros elsewhere)\n\\(D(a)\\) is a diagonal matrix with vector \\(a\\) on the diagonal\n\\(H(A)\\) is the symmetric part of matrix \\(A\\): \\(H(A) = \\frac{1}{2} (A + A^T)\\)\n\\(\\circ\\) is the Hadamard (element by element) product (i.e., \\(a \\circ b = c\\) with \\(c_i = a_i b_i\\), the same holds for matrices)\n\\(\\dfrac{d x(t)}{dt}\\) is sometimes written as \\(\\dfrac{d x}{dt}\\) or \\(\\dot{x}\\)"
  },
  {
    "objectID": "index.html#computing",
    "href": "index.html#computing",
    "title": "ICTS QSB 2025",
    "section": "",
    "text": "The GitHub repository associated with the lecture notes contains the code used to generate the lecture notes, including all the figures and simulations. Crucially, the code depends on the following R packages:\n\nlibrary(tidyverse) # plotting, data organization\nlibrary(deSolve) # integrate differential equations"
  },
  {
    "objectID": "index.html#notation",
    "href": "index.html#notation",
    "title": "ICTS QSB 2025",
    "section": "",
    "text": "We write \\(x(t)\\) for the density of population \\(x\\) at time \\(t\\). In many cases, we will write simply \\(x\\), as the dependency on time is always assumed. For discrete-time models, we write \\(x_t\\) instead. Typically, \\(x(t)\\) is measured in either \\([\\text{mass}]/[\\text{area/volume}]\\) or \\([\\text{number of individuals}]/[\\text{area/volume}]\\)\nThe density of a population typically changes in time, and the change is modulated by several parameters. Unless specified, we use Greek letters for scalars, lower-case Latin letters for vectors, and upper-case Latin letters for matrices.\nOther useful notation:\n\n\\(i\\) is the imaginary unit, such that \\(i^2 = -1\\)\n\\(0_n\\) is a vector of zeros of lenght \\(n\\)\n\\(1_n\\) is a vector of ones of lenght \\(n\\)\n\\(I\\) is the identity matrix (i.e., a matrix with \\(1_n\\) on the diagonal, and zeros elsewhere)\n\\(D(a)\\) is a diagonal matrix with vector \\(a\\) on the diagonal\n\\(H(A)\\) is the symmetric part of matrix \\(A\\): \\(H(A) = \\frac{1}{2} (A + A^T)\\)\n\\(\\circ\\) is the Hadamard (element by element) product (i.e., \\(a \\circ b = c\\) with \\(c_i = a_i b_i\\), the same holds for matrices)\n\\(\\dfrac{d x(t)}{dt}\\) is sometimes written as \\(\\dfrac{d x}{dt}\\) or \\(\\dot{x}\\)"
  },
  {
    "objectID": "ch1.html",
    "href": "ch1.html",
    "title": "The Generalized Lotka-Volterra model",
    "section": "",
    "text": "Alfred J. Lotka (1880-1949) was born to French-speaking American parents in Lemberg (then part of the Habsburg empire, now Lviv, Ukraine). He studied in France, Germany and England, receiving a BSc in 1901 and a DSc in 1912 from Birmingham university. He moved to the US in 1902, and worked at the US Patent office, as an editor of Scientific American, and as a statistician at the Metropolitan Life Insturance Company in NYC. He wrote more than a hundred papers and five books, spanning a wide range of topics. He’s best known for the book Elements of Physical Biology, his contributions to demography, and one of the first studies dealing with bibliometrics.\nStarting in 1910, he investigated coupled differential equations relating to chemical as well as ecological dynamics. In 1920 he studied a system of two ODEs that gave rise to perpetual oscillations: “It was, therefore, with considerable surprise that the writer, on applying his method to certain special cases, found these to lead to undamped, and hence indefinitely continued, oscillations.” He went on to describe “1. A species of organism \\(S_1\\), a plant species, say, deriving its nourishment from a source presented in such large excess that the mass of the source may be considered constant during the period of time with which we are concerned. 2. A species \\(S_2\\), for example a herbivorous animal species, feeding on \\(S_1\\).”\nThe equations he had derived (and then studied later in more detail) are now termed Lotka-Volterra equations.\n\n\n\n\n\nVito Volterra (1860-1940) was born in Ancona (then part of the Papal State) in a poor Jewish family. The financial situation precipitated with the death of his father, when Vito was two. Vito and his mother went to live with relatives in Turin and then Florence. Volterra showed amazing mathematical talent at a very young age. Antonio Roiti, professor of physics in Florence, noticed the budding mathematician and hired him as his assistant, so that he could continue his studies. He went on to enroll at the Scuola Normale in Pisa, receiving a degree in Physics in 1882. At age 23 he was made full professor of Rational Mechanics in Pisa, and then in 1900 of Mathematical Physics in Rome. For thirty years, he contributed important studies in mathematics, and enriched academic life in Italy (for example, he was the first director of the National Center for Research). In 1931 he refused to take an oath of loyalty to the fascist regime (only 12 professors out of 1250 refused), and was therefore forced to resign (his take on the fascist enterprise: “Empires die, but Euclid’s theorems keep their youth forever”).\nHis interest in mathematical ecology is due to Umberto D’Ancona (his son-in-law), who had studied the trends in fisheries in the Adriatic sea before and immediately after WWI. In 1914-1918 fisheries in the Adriatic had stopped completely because of the conflict. D’Ancona had noticed that, while herbivorous fish had remained about constant, the piscivorous fish had increased dramatically in numbers. The problem piqued Volterra who immediately published a sophisticated study, proposing the same equations studied by Lotka. In a short letter to Nature 1926, he stated the so-called “Volterra’s Effect” (which he termed “Law III”): “a complete closure of the fishery was a form of ‘protection’ under which the voracious fishes were much the better and prospered accordingly, but the ordinary food-fishes, on which these are accustomed to prey, were worse off than before.” This brief paper was a summary of a much more extensive study published in Italian.\n\n\nIn 1927, Lotka wrote to Nature to raise the issue that the equations studied by Volterra and the figures presented in Volterra’s brief article were identical to those found in Elements of Physical Biology (published in 1925). He concluded: “It would be gratifying if Prof. Volterra’s publication should direct attention to a field and method of inquiry which apparently has hitherto passed almost unnoticed.”\nVolterra graciously conceded “I recognize his priority, and am sorry not to have known his work, and therefore not have been able to mention it.” He however listed a few points in which the two authors had pursued different directions, and concluded “Working independently the one from the other, we have found some common results, and this confirms the exactitude and the interest in the position of the problem. I agree with him in his conclusions that these studies and these methods of research deserve to receive greated attention from scholars, and should give rise to important applications.”\n Vito Volterra and Umberto D’Ancona explore the Lotka-Volterra model. Taken from the fantastic La funzione del mondo, a graphic novel on Volterra by Bilotta and Grillotti.\n\n\n\n\nWe can write the GLV model for \\(n\\) interacting populations in component form as:\n\\[\n\\dfrac{d x_i(t)}{dt} = \\dot{x}_i = x_i \\left(r_i + \\sum_j A_{ij} x_j \\right)\n\\]\nand in matrix form as:\n\\[\n\\dot{x} = D(x) \\left(r + Ax \\right)\n\\]\nwhere \\(x = x(t)\\) is a (column) vector of length \\(n\\) containing the densities of all populations \\(1, \\ldots, n\\) at time \\(t\\), \\(r\\) is a vector of intrinsic growth rates (or death rates, when negative), measuring the growth (decline) of population \\(i\\) when growing alone at low density, and \\(A\\) is a \\(n \\times n\\) matrix of interaction coefficients. We use \\(D(x)\\) to denote the diagonal matrix with \\(x\\) on the diagonal.\nSometimes the model is written in a slightly different way, by bringing the vector \\(r\\) outside the parenthesis:\n\\[\n\\begin{aligned}\n\\dot{x}_i &= x_i \\left(r_i + \\sum_j A_{ij} x_j \\right)\\\\\n&= r_i x_i \\left(1 + \\frac{1}{r_i} \\sum_j A_{ij} x_j\\right)\\\\\n&= r_i x_i \\left(1 + \\sum_j B_{ij} x_j\\right)\\\\\n\\end{aligned}\n\\]\nwhere we have defined \\(B_{ij} = A_{ij} / r_i\\). In matrix form, we obtain:\n\\[\n\\dot{x} = D(x \\circ r) \\left(1_n + Bx \\right)\n\\]\nwhere \\(\\circ\\) is the Hadamard (element by element) product. This notation is convenient when computing the equilibria of the system; the previous notation is more convenient when investigating their stability. We will alternate between the two notations, using \\(A\\) and \\(B = D(r)^{-1} A\\) for the two matrices.\n\n\n\nIf an equilibrium \\(x^\\star\\) in which all populations are present exists, it must be the solution of\n\\[\n\\begin{aligned}\n1_n + Bx^\\star &= 0_n\\\\\nBx^\\star &= - 1_n\\\\\nx^\\star &= -B^{-1} 1_n\n\\end{aligned}\n\\]\nwhen the matrix \\(B\\) is invertible. Naturally, the equilibrium must be positive (called feasible) to be biologically attainable.\nFor example, consider:\n\\[\nA = \\begin{pmatrix}\n-4 & -1 & -3\\\\\n-14 & -8 & -10\\\\\n-6 & -15 & -13\n\\end{pmatrix} \\quad r = \\begin{pmatrix}\n8\\\\\n32\\\\\n34\n\\end{pmatrix}\\quad B = D(r)^{-1}A = \\begin{pmatrix}\n-\\frac{1}{2} & -\\frac{1}{8} & -\\frac{3}{8}\\\\\n-\\frac{7}{16} & -\\frac{1}{4} & -\\frac{5}{16}\\\\\n-\\frac{3}{17} & -\\frac{15}{34} & -\\frac{13}{34}\n\\end{pmatrix}\n\\] There is an equilibrium when at which all populations are present:\n\\[\nx^\\star = -A^{-1} r = -B^{-1}1_n = \\begin{pmatrix}\n1\\\\\n1\\\\\n1\n\\end{pmatrix}\n\\] If the matrix \\(B\\) is rank-deficient (and thus singular) there are infinitely many equilibria; for example, if the rank of \\(B\\) is \\(n-1\\) there are infinitely many equilibria belonging to a line in \\(\\mathbb R^n\\).\nWhen \\(B\\) is nonsingular, the model admits at most one positive equilibrium in which all populations are present. However, there can be up to \\(2^n-1\\) equilibria in which one or more populations are absent/extinct. Call \\(B^{(k,k)}\\) the submatrix of \\(B\\) obtained by retaining the rows and columns indexed by the set \\(k\\). Then by solving\n\\[\nB^{(k,k)} x^{(k)\\star} = -1^{(k)}\n\\]\nwe obtain an equilibrium for the subcommunity where only the populations in \\(k\\) are present (provided that the equilibrium is feasibile).\nFor the example above, we have:\n\\[\nB^{(\\{1,2\\},\\{1,2\\})} = \\begin{pmatrix}\n-\\frac{1}{2}& -\\frac{1}{8}\\\\\n-\\frac{7}{16} & -\\frac{1}{4}\n\\end{pmatrix}\n\\]\nand\n\\[\nx^{(\\{1,2\\})\\star} = -(B^{(\\{1,2\\},\\{1,2\\})})^{-1}1_2=\\begin{pmatrix}\n\\frac{16}{9}\\\\\n\\frac{8}{9}\n\\end{pmatrix}\n\\]\nTherefore, the subsystem in which only the first two populations are present has a feasible equilibrium.\nSimilarly,\n\\[\nx^{(\\{1,3\\})\\star} = \\begin{pmatrix}\n\\frac{1}{17}\\\\\n\\frac{44}{17}\n\\end{pmatrix} \\quad x^{(\\{1\\})\\star} = \\begin{pmatrix}\n2\\\\\n\\end{pmatrix} \\quad x^{(\\{2\\})\\star} = \\begin{pmatrix}\n4\\\\\n\\end{pmatrix} \\quad x^{(\\{3\\})\\star} = \\begin{pmatrix}\n\\frac{34}{13}\\\\\n\\end{pmatrix}\n\\]\nThe subsystem in which only populations 2 and 3 are present does not have a feasible equilibrium.\n\n\n\nFor a single population, the GLV model can yield only two outcomes: unbounded growth, or convergence to an equilibrium; if the equilibrium is \\(x^\\star = 0\\), we say that the population is extinct at the equilibrium.\n\n\n\n\n\nWhen we have two populations, we can also observe neutral cycles (as in the classic LV predator-prey system), and bistability (i.e., one population survives, while the other goes extinct; the identity of the population going extinct depends on the initial conditions).\n\n\n\n\n\nFor three populations we can observe limit cycles.\n\n\n\n\n\nFor four or more populations we can have chaos (i.e., non-periodic oscillations).\n\n\n\n\n\n\n\n\nSuppose that \\(x(t)\\) has a periodic orbit, of period \\(T\\) (i.e., we assume \\(x(0) = x(T)\\)). Further, assume that the GLV has a feasible, interior equilibrium \\(x^\\star\\). We want to calculate the average density for each species:\n\\[\n\\frac{1}{T} \\int_0^T x(t) dt\n\\]\nFirst, we assume that \\(x(t) &gt; 0\\) and write the dynamics of its logarithm:\n\\[\n\\dfrac{d \\log(x_i(t))}{dt} = \\dfrac{1}{x_i(t)}\\dfrac{d x_i(t)}{dt} = r_i + \\sum_j A_{ij} x_j(t)\n\\]\nIn vector form:\n\\[\n\\dfrac{d \\log{x(t)}}{dt}= r + A x(t)\n\\]\nCompute the average on both sides:\n\\[\n\\frac{1}{T}\\int_0^T \\frac{d \\log(x(t))}{dt} dt= \\frac{1}{T}\\int_0^T \\left(r + Ax(t) \\right) dt\n\\]\nyielding:\n\\[\n\\frac{1}{T}(\\log(x(T)) - \\log(x(0))) = 0_n = r + A \\left( \\frac{1}{T} \\int_0^T x(t) dt \\right)\n\\]\nNote that the l.h.s. is zero because \\(x(0) = x(T)\\). Now rearrange:\n\\[\n-r = A \\left( \\frac{1}{T} \\int_0^T x(t) dt \\right)\n\\]\nMultiplying by the matrix inverse:\n\\[\n-A^{-1} r = x^\\star =  \\frac{1}{T} \\int_0^T x(t) dt\n\\]\nshowing that the average density is in fact the equilibrium. With a similar argument, one can prove that if the trajectory stays in a compact space (i.e., in case of chaotic attractors), then the long-time average is still \\(x^\\star\\).\nA dynamical system is permanent if, for all \\(x_i(0) &gt; 0\\), the limit \\(\\liminf_{t \\to \\infty} x_i(t) &gt; \\delta &gt; 0\\) for all \\(i\\). This means that each axis of \\(\\mathbb R^n\\) repels the dynamics when \\(t\\) is large enough.\nSuppose that a GLV system is permanent, and that population dynamics converge to a limit cycle or a chaotic attractor; then, because of the calculation above, there must be a positive equilibrium in \\(\\mathbb R^n\\). Thus, a GLV system without a feasible equilibrium cannot be permanent. That is to say, the coexistence of all populations in a GLV system requires a feasible equilibrium.\n\n\n\n\n\nSolid lines: trajectories; dashed lines: equilibrium values; dotted line: (cumulative) average of trajectory.\n\n\n\n\n\n\n\nWe want to determine whether an equilibrium point is locally asymptotically stable; this means that, for sufficiently small perturbations of the equilibrium, \\(x(0) = x^\\star + \\epsilon\\), we have that \\(\\lim_{t \\to \\infty} x(t) = x^\\star\\). Let’s start by considering the case of a single population:\n\nTake an ODE \\(dx/dt = f(x)\\)\nThe population is resting at an equilibrium \\(x^\\star\\)\nWe perturb the population abundance, and track the dynamics when starting at \\(x(0) = x^\\star + \\epsilon\\), where \\(\\epsilon\\) (the perturbation) is taken to be sufficiently small \\(\\| \\epsilon \\| \\ll 1\\)\nWe write \\(\\Delta x(0) = x(0) - x^\\star\\)\nWe derive the dynamics for \\(\\Delta x\\).\n\nBy chain rule,\n\\[\n\\begin{aligned}\n\\dfrac{d \\Delta x}{dt} &= \\dfrac{d \\Delta x}{dx} \\dfrac{d x}{dt} \\\\\n&= 1 \\dfrac{d x}{dt}\\\\\n&= f(x)\\\\\n&= f(\\Delta x + x^\\star)\n\\end{aligned}\n\\]\nWhere we have substituted \\(x = \\Delta x + x^\\star\\).\n\nNow we approximate the function \\(f(\\Delta x + x^\\star)\\) by Taylor-expanding.\n\n\n\n\n\n\n\nTaylor series\n\n\n\n\n\nWe can approximate the behavior of a (infinitely differentiable) function in the vicinity of a point \\(a\\) by a power series:\n\\[\nf(x) = f(a) + \\dfrac{1}{1!} \\left. \\dfrac{df(x)}{dx} \\right|_a (x-a)+ \\dfrac{1}{2!} \\left. \\dfrac{d^2f(x)}{dx^2} \\right|_a (x-a)^2+ \\dfrac{1}{3!} \\left. \\dfrac{d^3f(x)}{dx^3} \\right|_a (x-a)^3 + \\ldots\n\\]\nwhere \\(n! = n (n-1)(n-2)\\ldots 1\\) is the factorial function and the derivatives are evaluated at \\(a\\). When we choose \\(a=0\\), this is called the Maclaurin series.\nExample\nExpand \\(e^x\\) around \\(0\\):\n\\[\n\\begin{aligned}\ne^x &= e^0 + \\left. e^x\\right|_0 x + \\frac{1}{2}\\left. e^x\\right|_0 x^2  + \\frac{1}{6}\\left. e^x\\right|_0 x^3 + \\ldots\\\\\n&=1 + x + \\frac{1}{2} x^2  + \\frac{1}{6}x^3 + \\ldots\\\\\n&=\\sum_{k=0}^\\infty \\frac{x^k}{k!}\n\\end{aligned}\n\\]\n\n\n\nWe want to Taylor-expand \\(f(x) = f(\\Delta x + x^\\star)\\) around \\(x^\\star\\):\n\\[\nf(x) = f(x^\\star) + \\left.\\dfrac{d f(x)}{d x}\\right|_{x^\\star} (x - x^\\star) + \\dfrac{1}{2}\\left.\\dfrac{d^2 f(x)}{d x^2}\\right|_{x^\\star} (x - x^\\star)^2 + \\ldots\n\\]\nNote that \\(f(x^\\star) = 0\\) by the definition of an equilibrium. If the deviation is small, we can neglect all the higher-order terms, obtaining:\n\\[\n\\dfrac{d \\Delta x}{dt} = f(x) \\approx \\left.\\dfrac{d f(x)}{d x}\\right|_{x^\\star} \\Delta x\n\\]\nwhich is the equation of the exponential growth model, with \\(\\rho = \\left.\\dfrac{d f(x)}{d x}\\right|_{x^\\star}\\). Then, the solution is \\(\\Delta x(t) = \\Delta x(0) e^{\\rho t}\\), and the deviation from the equilibrium eventually reaches zero (i.e., the system goes back to \\(x^\\star\\)) whenever \\(\\rho &lt; 0\\).\nFor example, take the logistic growth model \\(\\dot{x} = x(1-x)\\), and evaluate the stability of \\(x^\\star = 1\\); we have:\n\\[\n\\left.\\dfrac{d f(x)}{d x}\\right|_{x^\\star} = \\left.\\dfrac{d (x - x^2)}{d x}\\right|_{x^\\star} = \\left.(1 - 2x)\\right|_{x^\\star} = -1\n\\]\nand thus the equilibrium is locally asymptotically stable. Locally, because we have considered very small deviations from the equilibrium, and asymptotic because convergence only happens eventually.\nIn analogy with the Taylor-expansion of functions of a single variable, we can write:\n\\[\nf_i(x^\\star + \\Delta x) = f_i(x^\\star) + \\sum_k \\left. \\dfrac{\\partial f_i(x)}{\\partial x_k} \\right|_{x^\\star} \\Delta x_k + \\dfrac{1}{2} \\sum_{k}\\sum_{l} \\left. \\dfrac{\\partial^2 f_i(x)}{\\partial x_k \\partial x_l} \\right|_{x^\\star} \\Delta x_k \\Delta x_l + \\cdots\n\\]\nAs before, \\(f_i(x^\\star) = 0\\), and if we take only the second term (i.e., the term linear in \\(\\Delta x\\)) we can approximate the function as:\n\\[\nf_i(x^\\star + \\Delta x) \\approx \\sum_k \\left. J_{ik} \\right|_{x^\\star} \\Delta x_k\n\\]\nWhere we have defined the Jacobian matrix \\(J\\):\n\\[\nJ_{ij} = \\dfrac{\\partial f_i(x)}{\\partial x_j}\n\\]\nFor each equilibrium in the system, we can obtain a different community matrix (the name is due to Levins) \\(M\\):\n\\[\nM = \\left. J \\right|_{x^\\star}\n\\]\nAs such, a system of ODEs has a single Jacobian, and as many community matrices as there are equilibria. As before, we assume that we have slightly perturbed the system at equilibrium, \\(x(t) = x^\\star + \\Delta x\\), where \\(\\Delta x\\) is assumed to be small, and then we approximate the dynamics:\n\\[\n\\dfrac{d\\Delta x}{dt} \\approx \\left. J \\right|_{x^\\star} \\Delta x\n\\]\ni.e., we need to solve a linear system of ODEs.\n\n\n\n\n\n\nSolving systems of linear ODEs\n\n\n\n\n\nConsider the system of first-order, autonomous ODEs:\n\\[\n\\dfrac{dx}{dt} = Ax\n\\]\nIf the matrix \\(A\\) is diagonalizable, we can decompose the matrix as:\n\\[\nA = Q \\Lambda Q^{-1}\n\\]\nWe define a new system of equations, by changing the variables:\n\\[\ny = Q^{-1}x\\quad x = Q y\n\\]\nThen, by chain rule:\n\\[\n\\dfrac{dy}{dt} = Q^{-1} \\dfrac{d x}{dt} = Q^{-1}Q \\Lambda Q^{-1} x= \\Lambda Q^{-1} x = \\Lambda y\n\\]\nWe have decoupled all equations: now the \\(y_i\\) grow or decline independently of each other.\n\\[\n\\dfrac{dy_i}{dt} = \\lambda_i y_i\n\\]\nThis is in fact the equation for the exponential growth/decay, with solution \\(y_i(t) = y(0) e^{\\lambda_i t}\\).\nWe can bring these solutions back to the original form:\n\\[\ny(t) = e^{\\Lambda t} y(0)\n\\]\nwhere \\(e^\\Lambda t\\) is a diagonal matrix:\n\\[\ne^{\\Lambda t}= \\begin{pmatrix}\ne^{\\lambda_1 t} & 0 & \\cdots &0\\\\\n0 & e^{\\lambda_2 t} & \\cdots &0\\\\\n\\cdots & \\cdots & \\cdots & \\cdots\\\\\n0 & 0 & \\cdots & e^{\\lambda_n t}\\\\\n\\end{pmatrix}\n\\]\nThen:\n\\[\nx(t) = Q y(t) = Q e^{\\Lambda t} y(0) = Q e^{\\Lambda t} Q^{-1} x(0)\n\\]\nAllowing to easily compute the solution for any linear systems of ODEs.\nStability of the origin\nSuppose that \\(\\lambda_i\\) is a real, negative number; then \\(\\lim_{t \\to \\infty}e^{\\lambda_i t} = 0\\). If \\(\\lambda_i\\) is positive, on the other hand, then \\(\\lim_{t \\to \\infty}e^{\\lambda_i t} = \\infty\\). Thus, if any of the \\(\\lambda_i &gt; 0\\), the system will initially move toward \\(\\infty\\) in the direction specified by the corresponding eigenvector.\nWhenever \\(\\lambda_i\\) is complex (e.g., generically, when \\(A\\) is not symmetric), then we need to consider:\n\\[\ne^{\\alpha t + i \\beta t} = e^{\\alpha t} e^{i \\beta t} = e^{\\alpha t} (\\cos \\beta + i \\sin \\beta )t\n\\]\nwhere we have used Euler’s formula. Importantly, \\((\\cos \\beta + i \\sin \\beta )\\) is bounded, and in fact its real (imaginary) part is \\(\\leq 1\\) (the equation describes a unit circle in the complex plane). Then, \\(\\lim_{t \\to \\infty} e^{\\alpha t + i \\beta t} = 0\\) if \\(\\alpha &lt; 0\\).\nTherefore, the vector \\(0_n\\) is an asymptotically stable equilibrium of the system \\(\\dfrac{dx}{dt} = A x\\) if and only if all the eigenvalues of \\(A\\) have negative real part.\nStability of the origin for \\(A_{2 \\times 2}\\)\nAs we have shown above, the eigenvalues of a \\(2\\times2\\) matrix \\(A\\):\n\\[\nA = \\begin{pmatrix}\na & b\\\\\nc & d\n\\end{pmatrix}\n\\]\nare:\n\\[\n\\lambda = \\dfrac{a + d \\pm \\sqrt{4bc + (a-d)^2}}{2}\n\\]\nWe can rewrite the values as:\n\\[\n\\lambda = \\dfrac{1}{2} \\left(\\text{Tr}A \\pm\\sqrt{\\left(\\text{Tr}A \\right)^2 - 4 \\det A} \\right)\n\\]\nIf the trace is negative, and the determinant positive, then the eigenvalues have negative real part, and thus the origin is stable for the corresponding system of linear ODEs. In fact, knowing the trace and the determinant is in this case sufficient to determine the type of dynamics around equilibrium:\n\n\n\nCharacterizing dynamics using trace and determinant\n\n\n\n\n\nTo probe the local asymptotic stability of the equilibria, we can:\n\nCalculate the Jacobian matrix, \\(J\\)\nPlug in an equilibrium, obtaining the corresponding community matrix \\(M\\)\nCompute the eigenvalues of \\(M\\), \\(\\lambda_i\\)\nIf all the eigenvalues have negative real part, \\(\\Re (\\lambda_i) &lt; 0\\), then the equilibrium is locally asymptotically stable; if any \\(\\Re (\\lambda_i) &gt; 0\\), then the equilibrium is unstable, and there are small perturbations that will amplify (at least initially)\n\nFor the GLV system with equilibrium \\(x^\\star = -A^{-1}r &gt; 0_n\\), we have:\n\\[\nJ_{ii} = \\dfrac{\\partial (r_i x_i + \\sum_j A_{ij} x_i x_j)}{\\partial x_i}  = r_i + \\sum_j A_{ij} x_j + A_{ii} x_i\n\\]\nAt equilibrium, we have:\n\\[\nr_i + \\sum_j A_{ij} x_j^\\star = 0\n\\]\nand therefore\n\\[\nM_{ii} = \\left. J_{ii} \\right|_{x^\\star} = A_{ii} x_i^\\star\n\\]\nSimilarly,\n\\[\nJ_{ii} = \\dfrac{\\partial (r_i x_i + \\sum_j A_{ij} x_i x_j)}{\\partial x_j}  = A_{ij} x_i\n\\]\nand thus\n\\[\nM_{ij} = \\left. J_{ij} \\right|_{x^\\star} = A_{ij} x_i^\\star\n\\]\nPutting them together, we obtain:\n\\[\nM = \\left. J \\right|_{x^\\star} = D(x^\\star)A\n\\]\nand thus the equilibrium is l.a.s. if and only if all of the eigenvalues of \\(D(x^\\star)A\\) have negative real part.\nIf the matrix \\(A\\) is symmetric, any feasible equilibrium is stable if and only if the eigenvalues of \\(A\\) are all negative (i.e., \\(A\\) is negative definite). To prove this, take \\(A = A^T\\) and consider the similarity transformation\n\\[\n\\begin{aligned}\nD(x^\\star)^{-\\frac{1}{2}} D(x^\\star) A D(x^\\star)^{\\frac{1}{2}}\\\\\nD(x^\\star)^{\\frac{1}{2}}  A D(x^\\star)^{\\frac{1}{2}}\\\\\n\\end{aligned}\n\\]\nThe matrices \\(D(x^\\star) A\\) and \\(D(x^\\star)^{\\frac{1}{2}} A D(x^\\star)^{\\frac{1}{2}}\\) are similar, and thus have the same eigenvalues; the matrices \\(A\\) and \\(D(x^\\star)^{\\frac{1}{2}} A D(x^\\star)^{\\frac{1}{2}}\\) are congruent, and thus have the same number of positive, negative and zero eigenvalues by Sylvester’s law of inertia.\nA symmetric matrix is negative definite if all its submatrices obtained by deleting a set of rows and the corresponding columns are negative definite as well. Then, if \\(A = A^T\\) is negative definite, a) a feasible equilibrium is locally stable, and b) for any subsystem, feasibility implies local stability.\nNote that this is generally not the case for nonsymmetric matrices \\(A\\), in which case we could have that \\(A\\) has all eigenvalues with a negative real part, while \\(D(x^\\star)A\\) has some eigenvalues with positive real part (or viceversa). For example, take\n\\[\nA = \\begin{pmatrix}\n-3 & 4 & 0\\\\\n5 & -2 & -2\\\\\n5 & 5 & -3\n\\end{pmatrix} \\quad \\lambda(A) = \\{-7,\\frac{1}{2}(-1 \\pm i \\sqrt{15}) \\}\n\\]\nand the equilibrium \\(x^\\star = (1,1,1/2)^T\\) (obtained for \\(r = (-1, -2, -17/2)\\)); we obtain:\n\\[\nM = D(x^\\star)A = \\begin{pmatrix}\n-3 & 4 & 0\\\\\n5 & -2 & -2\\\\\n\\frac{5}{2} & \\frac{5}{2} & -\\frac{3}{2}\n\\end{pmatrix} \\quad \\lambda(B) = \\{-7,\\frac{1}{4}(1 \\pm i\\sqrt{31}) \\}\n\\]\nThus, the equilibrium is not locally asymptotically stable.\n\n\n\nIn certain models, we can show that whenever all the populations start at a positive value, they will always reach a certain equilibrium \\(x^\\star\\). In this case, we say the equilibrium is globally asymptotically stable.\nBecause solving differential equations is in general very difficult, and in many cases of interest impossible, we employ a proxy function, called a Lyapunov function.\n\n\n\n\n\n\nLyapunov functions\n\n\n\n\n\nWe want to prove that all trajectories originating at \\(x(0) &gt; 0\\) eventually converge to \\(x^\\star\\). If we can find a function \\(V\\) such that:\n\n\\(V(x(t)) \\geq 0\\) for all \\(x(t) &gt; 0\\)\n\\(V(x(t)) = 0\\) if and only if \\(x(t) = x^\\star\\)\n\\(\\dfrac{d V(x(t))}{dt} \\leq 0\\) for all \\(x(t)\\) and\n\\(\\dfrac{d V(x(t))}{dt} = 0\\) if and only if \\(x(t) = x^\\star\\)\n\nthen \\(x^\\star\\) is globally asymptotically stable: all trajectories starting at a positive point will converge to it.\nThe logic of this procedure is to identify a suitable function \\(V\\) that is positive everywhere but at the equilibrium, and is always declining in time; then necessarily the function will eventually reach zero, which is attained only at equilibrium.\nExample\n\\(V(x(t)) = (x(t) - x^\\star)^2\\) is a Lyapunov function for the logistic growth model \\(dx/dt = x(1-x)\\): the model has an equilibrium \\(x^\\star = 1\\) that is globally asymptotically stable.\n\n\\(V(x(t))\\) is always nonnegative, and is zero only at \\(x(t) = x^\\star = 1\\)\nThe derivative of \\(V(x(t))\\) w.r.t. time is:\n\n\\[\n\\begin{aligned}\n\\dfrac{dV(t)}{dt} &= \\dfrac{dV(t)}{dx(t)}\\dfrac{dx(t)}{dt}\\\\\n&= 2(x(t) - x^\\star)\\dfrac{dx(t)}{dt}\\\\\n&=-2(x(t)-1) x(t)(x(t)-1)\\\\\n&=-2 x(t) (x(t)-1)^2 \\leq 0\n\\end{aligned}\n\\]\n\n\n\nThere are two classic candidate Lyapunov functions for Lotka-Volterra models. The first is due to MacArthur, and shows that, when interactions are symmetric and the matrix of interactions is negative definite (i.e., has only negative eigenvalues), the feasible equilibrium is globally stable.\nWe consider a slightly modified version of MacArthur’s function, and assume \\(A = A^T\\):\n\\[\nW(x) = r^Tx^\\star - (2 r^T x + x^T A x)\n\\]\nWhenever \\(A\\) is negative definite, then \\(W(x(t))\\) is positive everywhere but at equilibrium (the function is convex), and has a single minimum at the equilibrium. Note that, whenever \\(x^\\star &gt; 0_n\\) is an equilibrium, then\n\\[\n\\begin{aligned}\nr + A x^\\star &= 0_n\\\\\nr &= -Ax^\\star\n\\end{aligned}\n\\]\nSubstitute these values in the function \\(W\\), to obtain:\n\\[\n\\begin{aligned}\nW(x^\\star) &= r^Tx^\\star - (2 r^T x^\\star + (x^\\star)^T A x^\\star) \\\\\n&=r^Tx^\\star - (2 r^T x^\\star + ((x^\\star) A)^T x^\\star)\\\\\n&=r^Tx^\\star - (2 r^T x^\\star -r^T x^\\star)\\\\\n&=0_n\n\\end{aligned}\n\\]\nDifferentiating with respect to time, we find:\n\\[\n\\begin{aligned}\n\\dot{W}(x(t)) &= -(2 r^T \\dot{x} + \\dot{x}^T A x + x^T A \\dot{x})\\\\\n&= -(2 r^T \\dot{x} + \\dot{x}^T A^T x + x^T A \\dot{x})\\\\\n&= -2 (r + Ax)^T \\dot{x}\\\\\n&= -2 (r + Ax)^T D(x) (r + Ax)\\\\\n&=-2 \\sum_i x_i (r_i + (Ax)_i)^2 \\leq 0\n\\end{aligned}\n\\]\nA more general candidate Lyapunov function is due to Goh, and shows that, whenever there exists a positive diagonal matrix \\(D(w)\\) such that \\(D(w)A^T + AD(w)\\) is negative definite, then the equilibrium \\(x^\\star &gt; 0_n\\) is globally stable.\nWe start with the simplest case in which \\(w = 1_n\\) and thus \\(D(w) = I\\). Take the function\n\\[\nV(x(t)) = \\sum_i \\left(x_i - x_i^\\star - x_i^\\star \\log \\frac{x_i}{x_i^\\star} \\right)\n\\]\nThe function is positive for every \\(x \\in \\mathbb {R^n}_+\\), because \\(z - 1 - \\log z \\geq 0\\) whenever \\(z &gt; 0\\); take \\(z = x_i / {x_i}^\\star\\) and then multiply by \\({x_i}^\\star\\) to prove that the function is nonnegative.\nDifferentiating with respect to time, we find:\n\\[\n\\begin{aligned}\n\\dot{V}(x(t)) &= \\sum_i \\left(\\dot{x}_i - x_i^\\star \\frac{\\dot{x}_i}{x_i} \\right)\\\\\n&= \\sum_i \\left(x_i (r_i + (Ax)_i) - x_i^\\star (r_i + (Ax)_i)\\right)\\\\\n&=\\sum_i \\Delta x_i (-(Ax^\\star)_i + (Ax)_i )\\\\\n&=\\sum_{i,j}\\Delta x_i A_{ij} \\Delta x_j\\\\\n&=\\Delta x^T A \\Delta x\\\\\n&=\\frac{1}{2}\\Delta x^T (A + A^T)\\Delta x\\\\\n\\end{aligned}\n\\]\nThus, if the symmetric part of \\(A\\), \\(H(A) = \\frac{1}{2} (A + A^T)\\) is negative definite, then \\(\\dot{V}(x(t))&lt;0\\) for every \\(\\Delta x \\neq 0\\) and the equilibrium is stable.\nTo extend the reach of the candidate function, consider the change of variables:\n\\[\nz_i = x_i / w_i \\quad x_i = w_i z_i\n\\]\nwith \\(w_i&gt;0\\). This change of variables cannot impact the existence or stability of equilibria (we are simply changing the unit of measure we Then,\n\\[\n\\dot{z_i} = \\frac{\\dot{x}_i}{w_i} = \\frac{x_i}{w_i}(r_i + (Ax)_i) = z_i(r_i + (AD(w)z)_i)=z_i(r_i + (\\tilde{A}z)_i)\n\\]\nThus, if \\(H(\\tilde{A}) = \\frac{1}{2} (AD(w) + D(w)A^T)\\) is negative definite, the equilibrium is stable.\n\n\n\nWhen Goh’s function holds, we can prove that dynamics starting from positive conditions \\(x(t)&gt;0_n\\) will converge to a saturated equilibrium \\(\\tilde{x}\\) characterized by two conditions. We have \\(n\\) populations, and at the saturated equilibrium the populations in set \\(k\\) coexist at a globally stable equilibrium, and the remaining populations, belonging to set \\(n-k\\) are extinct, and cannot re-invade the system starting from low abundance.\nWithout loss of generality, we can order the populations such that the first \\(\\|k\\|\\) populations are those that coexist at the saturated equilibrium, and the remaining \\(\\| n- k\\|\\) are those extinct at the saturated equilibrium. We partition all variables according to the two sets:\n\\[\nx = \\begin{pmatrix}\ny\\\\\nz\n\\end{pmatrix} \\quad \\tilde{x} = \\begin{pmatrix}\ny^\\star\\\\\n0_{n-k}\n\\end{pmatrix} \\quad A = \\begin{pmatrix}\n\\mathfrak A & \\mathfrak B\\\\\n\\mathfrak C & \\mathfrak D\n\\end{pmatrix}\\quad r = \\begin{pmatrix}\n\\mathfrak r\\\\\n\\mathfrak s\n\\end{pmatrix}\n\\]\nWe consider a minor modification of Goh’s function:\n\\[\nV(x (t)) = \\sum_{i \\in k} \\left(y_i - y_i^\\star - y_i^\\star \\log \\frac{y_i}{y_i^\\star} \\right) +\n\\sum_{i \\in n-k} z_i\n\\]\nDifferentiating with respect to time, we obtain:\n\\[\n\\begin{aligned}\n\\dot{V}(x(t)) &= \\sum_{i \\in k} \\left(\\dot{y}_i - y_i^\\star \\frac{\\dot{y}_i}{y_i} \\right)+\\sum_{i \\in n-k} \\dot{z}_i\\\\\n&=\\Delta y^T(\\mathfrak r + \\mathfrak A y + \\mathfrak Bz) + z^T(\\mathfrak s + \\mathfrak C y+ \\mathfrak D z)\n\\end{aligned}\n\\]\nNow we substitute \\(\\mathfrak r = -\\mathfrak A y^\\star\\), and add and subtract \\(z^T \\mathfrak C y^\\star\\):\n\\[\n\\begin{aligned}\n\\dot{V}(x(t)) &=\\Delta y^T(-\\mathfrak A y^\\star + \\mathfrak A y + \\mathfrak Bz) + z^T(\\mathfrak s + \\mathfrak C y+ \\mathfrak D z  + \\mathfrak C y^\\star - \\mathfrak C y^\\star)\\\\\n&=\\Delta y^T(\\mathfrak A \\Delta y + \\mathfrak Bz) + z^T(\\mathfrak s + \\mathfrak C \\Delta y+ \\mathfrak D z  + \\mathfrak C y^\\star)\n\\end{aligned}\n\\] Now we write the function as the sum of two parts:\n\\[\n\\begin{aligned}\n\\dot{V}(x(t)) &= (\\Delta y^T \\mathfrak A \\Delta y + \\Delta y^T \\mathfrak B z + z^T \\mathfrak C \\Delta y + z^T \\mathfrak D z) + z^T(s + \\mathfrak C y^\\star)\\\\\n&= \\begin{pmatrix}\n\\Delta y\\\\\nz\n\\end{pmatrix}^T \\begin{pmatrix}\n\\mathfrak A & \\mathfrak B\\\\\n\\mathfrak C & \\mathfrak D\n\\end{pmatrix}\\begin{pmatrix}\n\\Delta y\\\\\nz\n\\end{pmatrix}+ z^T(s + \\mathfrak C y^\\star)\\\\\\\\\n&= \\begin{pmatrix}\n\\Delta y\\\\\nz\n\\end{pmatrix}^T A\\begin{pmatrix}\n\\Delta y\\\\\nz\n\\end{pmatrix}+ z^T(s + \\mathfrak C y^\\star)\\\\\\\\\n\\end{aligned}\n\\]\nWhenever \\(H(A) = \\frac{1}{2}(A + A^T)\\) is negative definite, then the first term is negative for any choice of \\(y\\) and \\(z\\). Examining the second term, we see that \\(\\mathfrak s + \\mathfrak C y^\\star\\) measures the invasion growth rate of the populations in the set \\(n-k\\) when they are attempting to invade the community that is resting at \\(y^\\star\\). Thus, if we can find a saturated equilibrium, it is globally stable and will be reached for any \\(x(0) &gt; 0_n\\).\n\n\n\nA brief paper discussing how to build models in biology:\n\nRichard Levins, 1966. The strategy of model building in population biology. American Scientist 54:421-431\n\nThe Lotka-Volterra predator-prey model was discovered independently by Alfred J. Lotka and Vito Volterra:\n\nAlfred J. Lotka, 1920. Analytical Note on Certain Rhythmic Relations in Organic Systems. PNAS 6 (7) 410-415\nVito Volterra, 1926. Fluctuations in the Abundance of a Species Considered Mathematically. Nature 118:558-60\n\nYou can read their exchange here.\nThe constant of motion that underlies the candidate Lyapunov functions was derived by Lotka in 1920:\n\nAlfred J. Lotka, 1920. Undamped oscillations derived from the law of mass action. Journal of the American Chemical Society 42:1595-1599\n\nVolterra considered many variations, including the competition between species. His results caught the eye of an experimentalist, who validated the principle of competitive exclusion using protozoans:\n\nG.F. Gause, 1934. Experimental Analysis of Vito Volterra’s Mathematical Theory of the Struggle for Existence. Science 79:16-17\n\nThe paper by MacArthur, on consumer-resource dynamics:\n\nR. MacArthur, 1970. Species packing and competitive equilibrium for many species. Theoretical population biology, 1(1), pp.1-11.\n\nThe paper by B.S. Goh on global stability:\n\nB.S. Goh, 1977. Global stability in many-species systems. The American Naturalist, 111(977), pp.135-143.\n\nThe convergence to saturated equilibria has strong implications for ecological assembly. See for example:\n\nJ. Hofbauer, S.J. Schreiber, 2022. Permanence via invasion graphs: incorporating community assembly into modern coexistence theory. Journal of mathematical biology. Nov;85(5):54.\nC.A. Serván, S. Allesina, 2021. Tractable models of ecological assembly. Ecology Letters May;24(5):1029-37.\n\nI have recently written a paper on Lyapunov functions for GLV that extends and generalizes Goh’s function. Ask me about it if you want to know more!\n\nS. Allesina, 2025. Global stability of ecological and evolutionary dynamics via equivalence. In review"
  },
  {
    "objectID": "ch1.html#history",
    "href": "ch1.html#history",
    "title": "The Generalized Lotka-Volterra model",
    "section": "",
    "text": "Alfred J. Lotka (1880-1949) was born to French-speaking American parents in Lemberg (then part of the Habsburg empire, now Lviv, Ukraine). He studied in France, Germany and England, receiving a BSc in 1901 and a DSc in 1912 from Birmingham university. He moved to the US in 1902, and worked at the US Patent office, as an editor of Scientific American, and as a statistician at the Metropolitan Life Insturance Company in NYC. He wrote more than a hundred papers and five books, spanning a wide range of topics. He’s best known for the book Elements of Physical Biology, his contributions to demography, and one of the first studies dealing with bibliometrics.\nStarting in 1910, he investigated coupled differential equations relating to chemical as well as ecological dynamics. In 1920 he studied a system of two ODEs that gave rise to perpetual oscillations: “It was, therefore, with considerable surprise that the writer, on applying his method to certain special cases, found these to lead to undamped, and hence indefinitely continued, oscillations.” He went on to describe “1. A species of organism \\(S_1\\), a plant species, say, deriving its nourishment from a source presented in such large excess that the mass of the source may be considered constant during the period of time with which we are concerned. 2. A species \\(S_2\\), for example a herbivorous animal species, feeding on \\(S_1\\).”\nThe equations he had derived (and then studied later in more detail) are now termed Lotka-Volterra equations.\n\n\n\n\n\nVito Volterra (1860-1940) was born in Ancona (then part of the Papal State) in a poor Jewish family. The financial situation precipitated with the death of his father, when Vito was two. Vito and his mother went to live with relatives in Turin and then Florence. Volterra showed amazing mathematical talent at a very young age. Antonio Roiti, professor of physics in Florence, noticed the budding mathematician and hired him as his assistant, so that he could continue his studies. He went on to enroll at the Scuola Normale in Pisa, receiving a degree in Physics in 1882. At age 23 he was made full professor of Rational Mechanics in Pisa, and then in 1900 of Mathematical Physics in Rome. For thirty years, he contributed important studies in mathematics, and enriched academic life in Italy (for example, he was the first director of the National Center for Research). In 1931 he refused to take an oath of loyalty to the fascist regime (only 12 professors out of 1250 refused), and was therefore forced to resign (his take on the fascist enterprise: “Empires die, but Euclid’s theorems keep their youth forever”).\nHis interest in mathematical ecology is due to Umberto D’Ancona (his son-in-law), who had studied the trends in fisheries in the Adriatic sea before and immediately after WWI. In 1914-1918 fisheries in the Adriatic had stopped completely because of the conflict. D’Ancona had noticed that, while herbivorous fish had remained about constant, the piscivorous fish had increased dramatically in numbers. The problem piqued Volterra who immediately published a sophisticated study, proposing the same equations studied by Lotka. In a short letter to Nature 1926, he stated the so-called “Volterra’s Effect” (which he termed “Law III”): “a complete closure of the fishery was a form of ‘protection’ under which the voracious fishes were much the better and prospered accordingly, but the ordinary food-fishes, on which these are accustomed to prey, were worse off than before.” This brief paper was a summary of a much more extensive study published in Italian.\n\n\nIn 1927, Lotka wrote to Nature to raise the issue that the equations studied by Volterra and the figures presented in Volterra’s brief article were identical to those found in Elements of Physical Biology (published in 1925). He concluded: “It would be gratifying if Prof. Volterra’s publication should direct attention to a field and method of inquiry which apparently has hitherto passed almost unnoticed.”\nVolterra graciously conceded “I recognize his priority, and am sorry not to have known his work, and therefore not have been able to mention it.” He however listed a few points in which the two authors had pursued different directions, and concluded “Working independently the one from the other, we have found some common results, and this confirms the exactitude and the interest in the position of the problem. I agree with him in his conclusions that these studies and these methods of research deserve to receive greated attention from scholars, and should give rise to important applications.”\n Vito Volterra and Umberto D’Ancona explore the Lotka-Volterra model. Taken from the fantastic La funzione del mondo, a graphic novel on Volterra by Bilotta and Grillotti."
  },
  {
    "objectID": "ch1.html#equations",
    "href": "ch1.html#equations",
    "title": "The Generalized Lotka-Volterra model",
    "section": "",
    "text": "We can write the GLV model for \\(n\\) interacting populations in component form as:\n\\[\n\\dfrac{d x_i(t)}{dt} = \\dot{x}_i = x_i \\left(r_i + \\sum_j A_{ij} x_j \\right)\n\\]\nand in matrix form as:\n\\[\n\\dot{x} = D(x) \\left(r + Ax \\right)\n\\]\nwhere \\(x = x(t)\\) is a (column) vector of length \\(n\\) containing the densities of all populations \\(1, \\ldots, n\\) at time \\(t\\), \\(r\\) is a vector of intrinsic growth rates (or death rates, when negative), measuring the growth (decline) of population \\(i\\) when growing alone at low density, and \\(A\\) is a \\(n \\times n\\) matrix of interaction coefficients. We use \\(D(x)\\) to denote the diagonal matrix with \\(x\\) on the diagonal.\nSometimes the model is written in a slightly different way, by bringing the vector \\(r\\) outside the parenthesis:\n\\[\n\\begin{aligned}\n\\dot{x}_i &= x_i \\left(r_i + \\sum_j A_{ij} x_j \\right)\\\\\n&= r_i x_i \\left(1 + \\frac{1}{r_i} \\sum_j A_{ij} x_j\\right)\\\\\n&= r_i x_i \\left(1 + \\sum_j B_{ij} x_j\\right)\\\\\n\\end{aligned}\n\\]\nwhere we have defined \\(B_{ij} = A_{ij} / r_i\\). In matrix form, we obtain:\n\\[\n\\dot{x} = D(x \\circ r) \\left(1_n + Bx \\right)\n\\]\nwhere \\(\\circ\\) is the Hadamard (element by element) product. This notation is convenient when computing the equilibria of the system; the previous notation is more convenient when investigating their stability. We will alternate between the two notations, using \\(A\\) and \\(B = D(r)^{-1} A\\) for the two matrices."
  },
  {
    "objectID": "ch1.html#equilibria",
    "href": "ch1.html#equilibria",
    "title": "The Generalized Lotka-Volterra model",
    "section": "",
    "text": "If an equilibrium \\(x^\\star\\) in which all populations are present exists, it must be the solution of\n\\[\n\\begin{aligned}\n1_n + Bx^\\star &= 0_n\\\\\nBx^\\star &= - 1_n\\\\\nx^\\star &= -B^{-1} 1_n\n\\end{aligned}\n\\]\nwhen the matrix \\(B\\) is invertible. Naturally, the equilibrium must be positive (called feasible) to be biologically attainable.\nFor example, consider:\n\\[\nA = \\begin{pmatrix}\n-4 & -1 & -3\\\\\n-14 & -8 & -10\\\\\n-6 & -15 & -13\n\\end{pmatrix} \\quad r = \\begin{pmatrix}\n8\\\\\n32\\\\\n34\n\\end{pmatrix}\\quad B = D(r)^{-1}A = \\begin{pmatrix}\n-\\frac{1}{2} & -\\frac{1}{8} & -\\frac{3}{8}\\\\\n-\\frac{7}{16} & -\\frac{1}{4} & -\\frac{5}{16}\\\\\n-\\frac{3}{17} & -\\frac{15}{34} & -\\frac{13}{34}\n\\end{pmatrix}\n\\] There is an equilibrium when at which all populations are present:\n\\[\nx^\\star = -A^{-1} r = -B^{-1}1_n = \\begin{pmatrix}\n1\\\\\n1\\\\\n1\n\\end{pmatrix}\n\\] If the matrix \\(B\\) is rank-deficient (and thus singular) there are infinitely many equilibria; for example, if the rank of \\(B\\) is \\(n-1\\) there are infinitely many equilibria belonging to a line in \\(\\mathbb R^n\\).\nWhen \\(B\\) is nonsingular, the model admits at most one positive equilibrium in which all populations are present. However, there can be up to \\(2^n-1\\) equilibria in which one or more populations are absent/extinct. Call \\(B^{(k,k)}\\) the submatrix of \\(B\\) obtained by retaining the rows and columns indexed by the set \\(k\\). Then by solving\n\\[\nB^{(k,k)} x^{(k)\\star} = -1^{(k)}\n\\]\nwe obtain an equilibrium for the subcommunity where only the populations in \\(k\\) are present (provided that the equilibrium is feasibile).\nFor the example above, we have:\n\\[\nB^{(\\{1,2\\},\\{1,2\\})} = \\begin{pmatrix}\n-\\frac{1}{2}& -\\frac{1}{8}\\\\\n-\\frac{7}{16} & -\\frac{1}{4}\n\\end{pmatrix}\n\\]\nand\n\\[\nx^{(\\{1,2\\})\\star} = -(B^{(\\{1,2\\},\\{1,2\\})})^{-1}1_2=\\begin{pmatrix}\n\\frac{16}{9}\\\\\n\\frac{8}{9}\n\\end{pmatrix}\n\\]\nTherefore, the subsystem in which only the first two populations are present has a feasible equilibrium.\nSimilarly,\n\\[\nx^{(\\{1,3\\})\\star} = \\begin{pmatrix}\n\\frac{1}{17}\\\\\n\\frac{44}{17}\n\\end{pmatrix} \\quad x^{(\\{1\\})\\star} = \\begin{pmatrix}\n2\\\\\n\\end{pmatrix} \\quad x^{(\\{2\\})\\star} = \\begin{pmatrix}\n4\\\\\n\\end{pmatrix} \\quad x^{(\\{3\\})\\star} = \\begin{pmatrix}\n\\frac{34}{13}\\\\\n\\end{pmatrix}\n\\]\nThe subsystem in which only populations 2 and 3 are present does not have a feasible equilibrium."
  },
  {
    "objectID": "ch1.html#types-of-dynamics",
    "href": "ch1.html#types-of-dynamics",
    "title": "The Generalized Lotka-Volterra model",
    "section": "",
    "text": "For a single population, the GLV model can yield only two outcomes: unbounded growth, or convergence to an equilibrium; if the equilibrium is \\(x^\\star = 0\\), we say that the population is extinct at the equilibrium.\n\n\n\n\n\nWhen we have two populations, we can also observe neutral cycles (as in the classic LV predator-prey system), and bistability (i.e., one population survives, while the other goes extinct; the identity of the population going extinct depends on the initial conditions).\n\n\n\n\n\nFor three populations we can observe limit cycles.\n\n\n\n\n\nFor four or more populations we can have chaos (i.e., non-periodic oscillations)."
  },
  {
    "objectID": "ch1.html#equilibrium-as-time-average",
    "href": "ch1.html#equilibrium-as-time-average",
    "title": "The Generalized Lotka-Volterra model",
    "section": "",
    "text": "Suppose that \\(x(t)\\) has a periodic orbit, of period \\(T\\) (i.e., we assume \\(x(0) = x(T)\\)). Further, assume that the GLV has a feasible, interior equilibrium \\(x^\\star\\). We want to calculate the average density for each species:\n\\[\n\\frac{1}{T} \\int_0^T x(t) dt\n\\]\nFirst, we assume that \\(x(t) &gt; 0\\) and write the dynamics of its logarithm:\n\\[\n\\dfrac{d \\log(x_i(t))}{dt} = \\dfrac{1}{x_i(t)}\\dfrac{d x_i(t)}{dt} = r_i + \\sum_j A_{ij} x_j(t)\n\\]\nIn vector form:\n\\[\n\\dfrac{d \\log{x(t)}}{dt}= r + A x(t)\n\\]\nCompute the average on both sides:\n\\[\n\\frac{1}{T}\\int_0^T \\frac{d \\log(x(t))}{dt} dt= \\frac{1}{T}\\int_0^T \\left(r + Ax(t) \\right) dt\n\\]\nyielding:\n\\[\n\\frac{1}{T}(\\log(x(T)) - \\log(x(0))) = 0_n = r + A \\left( \\frac{1}{T} \\int_0^T x(t) dt \\right)\n\\]\nNote that the l.h.s. is zero because \\(x(0) = x(T)\\). Now rearrange:\n\\[\n-r = A \\left( \\frac{1}{T} \\int_0^T x(t) dt \\right)\n\\]\nMultiplying by the matrix inverse:\n\\[\n-A^{-1} r = x^\\star =  \\frac{1}{T} \\int_0^T x(t) dt\n\\]\nshowing that the average density is in fact the equilibrium. With a similar argument, one can prove that if the trajectory stays in a compact space (i.e., in case of chaotic attractors), then the long-time average is still \\(x^\\star\\).\nA dynamical system is permanent if, for all \\(x_i(0) &gt; 0\\), the limit \\(\\liminf_{t \\to \\infty} x_i(t) &gt; \\delta &gt; 0\\) for all \\(i\\). This means that each axis of \\(\\mathbb R^n\\) repels the dynamics when \\(t\\) is large enough.\nSuppose that a GLV system is permanent, and that population dynamics converge to a limit cycle or a chaotic attractor; then, because of the calculation above, there must be a positive equilibrium in \\(\\mathbb R^n\\). Thus, a GLV system without a feasible equilibrium cannot be permanent. That is to say, the coexistence of all populations in a GLV system requires a feasible equilibrium.\n\n\n\n\n\nSolid lines: trajectories; dashed lines: equilibrium values; dotted line: (cumulative) average of trajectory."
  },
  {
    "objectID": "ch1.html#local-stability",
    "href": "ch1.html#local-stability",
    "title": "The Generalized Lotka-Volterra model",
    "section": "",
    "text": "We want to determine whether an equilibrium point is locally asymptotically stable; this means that, for sufficiently small perturbations of the equilibrium, \\(x(0) = x^\\star + \\epsilon\\), we have that \\(\\lim_{t \\to \\infty} x(t) = x^\\star\\). Let’s start by considering the case of a single population:\n\nTake an ODE \\(dx/dt = f(x)\\)\nThe population is resting at an equilibrium \\(x^\\star\\)\nWe perturb the population abundance, and track the dynamics when starting at \\(x(0) = x^\\star + \\epsilon\\), where \\(\\epsilon\\) (the perturbation) is taken to be sufficiently small \\(\\| \\epsilon \\| \\ll 1\\)\nWe write \\(\\Delta x(0) = x(0) - x^\\star\\)\nWe derive the dynamics for \\(\\Delta x\\).\n\nBy chain rule,\n\\[\n\\begin{aligned}\n\\dfrac{d \\Delta x}{dt} &= \\dfrac{d \\Delta x}{dx} \\dfrac{d x}{dt} \\\\\n&= 1 \\dfrac{d x}{dt}\\\\\n&= f(x)\\\\\n&= f(\\Delta x + x^\\star)\n\\end{aligned}\n\\]\nWhere we have substituted \\(x = \\Delta x + x^\\star\\).\n\nNow we approximate the function \\(f(\\Delta x + x^\\star)\\) by Taylor-expanding.\n\n\n\n\n\n\n\nTaylor series\n\n\n\n\n\nWe can approximate the behavior of a (infinitely differentiable) function in the vicinity of a point \\(a\\) by a power series:\n\\[\nf(x) = f(a) + \\dfrac{1}{1!} \\left. \\dfrac{df(x)}{dx} \\right|_a (x-a)+ \\dfrac{1}{2!} \\left. \\dfrac{d^2f(x)}{dx^2} \\right|_a (x-a)^2+ \\dfrac{1}{3!} \\left. \\dfrac{d^3f(x)}{dx^3} \\right|_a (x-a)^3 + \\ldots\n\\]\nwhere \\(n! = n (n-1)(n-2)\\ldots 1\\) is the factorial function and the derivatives are evaluated at \\(a\\). When we choose \\(a=0\\), this is called the Maclaurin series.\nExample\nExpand \\(e^x\\) around \\(0\\):\n\\[\n\\begin{aligned}\ne^x &= e^0 + \\left. e^x\\right|_0 x + \\frac{1}{2}\\left. e^x\\right|_0 x^2  + \\frac{1}{6}\\left. e^x\\right|_0 x^3 + \\ldots\\\\\n&=1 + x + \\frac{1}{2} x^2  + \\frac{1}{6}x^3 + \\ldots\\\\\n&=\\sum_{k=0}^\\infty \\frac{x^k}{k!}\n\\end{aligned}\n\\]\n\n\n\nWe want to Taylor-expand \\(f(x) = f(\\Delta x + x^\\star)\\) around \\(x^\\star\\):\n\\[\nf(x) = f(x^\\star) + \\left.\\dfrac{d f(x)}{d x}\\right|_{x^\\star} (x - x^\\star) + \\dfrac{1}{2}\\left.\\dfrac{d^2 f(x)}{d x^2}\\right|_{x^\\star} (x - x^\\star)^2 + \\ldots\n\\]\nNote that \\(f(x^\\star) = 0\\) by the definition of an equilibrium. If the deviation is small, we can neglect all the higher-order terms, obtaining:\n\\[\n\\dfrac{d \\Delta x}{dt} = f(x) \\approx \\left.\\dfrac{d f(x)}{d x}\\right|_{x^\\star} \\Delta x\n\\]\nwhich is the equation of the exponential growth model, with \\(\\rho = \\left.\\dfrac{d f(x)}{d x}\\right|_{x^\\star}\\). Then, the solution is \\(\\Delta x(t) = \\Delta x(0) e^{\\rho t}\\), and the deviation from the equilibrium eventually reaches zero (i.e., the system goes back to \\(x^\\star\\)) whenever \\(\\rho &lt; 0\\).\nFor example, take the logistic growth model \\(\\dot{x} = x(1-x)\\), and evaluate the stability of \\(x^\\star = 1\\); we have:\n\\[\n\\left.\\dfrac{d f(x)}{d x}\\right|_{x^\\star} = \\left.\\dfrac{d (x - x^2)}{d x}\\right|_{x^\\star} = \\left.(1 - 2x)\\right|_{x^\\star} = -1\n\\]\nand thus the equilibrium is locally asymptotically stable. Locally, because we have considered very small deviations from the equilibrium, and asymptotic because convergence only happens eventually.\nIn analogy with the Taylor-expansion of functions of a single variable, we can write:\n\\[\nf_i(x^\\star + \\Delta x) = f_i(x^\\star) + \\sum_k \\left. \\dfrac{\\partial f_i(x)}{\\partial x_k} \\right|_{x^\\star} \\Delta x_k + \\dfrac{1}{2} \\sum_{k}\\sum_{l} \\left. \\dfrac{\\partial^2 f_i(x)}{\\partial x_k \\partial x_l} \\right|_{x^\\star} \\Delta x_k \\Delta x_l + \\cdots\n\\]\nAs before, \\(f_i(x^\\star) = 0\\), and if we take only the second term (i.e., the term linear in \\(\\Delta x\\)) we can approximate the function as:\n\\[\nf_i(x^\\star + \\Delta x) \\approx \\sum_k \\left. J_{ik} \\right|_{x^\\star} \\Delta x_k\n\\]\nWhere we have defined the Jacobian matrix \\(J\\):\n\\[\nJ_{ij} = \\dfrac{\\partial f_i(x)}{\\partial x_j}\n\\]\nFor each equilibrium in the system, we can obtain a different community matrix (the name is due to Levins) \\(M\\):\n\\[\nM = \\left. J \\right|_{x^\\star}\n\\]\nAs such, a system of ODEs has a single Jacobian, and as many community matrices as there are equilibria. As before, we assume that we have slightly perturbed the system at equilibrium, \\(x(t) = x^\\star + \\Delta x\\), where \\(\\Delta x\\) is assumed to be small, and then we approximate the dynamics:\n\\[\n\\dfrac{d\\Delta x}{dt} \\approx \\left. J \\right|_{x^\\star} \\Delta x\n\\]\ni.e., we need to solve a linear system of ODEs.\n\n\n\n\n\n\nSolving systems of linear ODEs\n\n\n\n\n\nConsider the system of first-order, autonomous ODEs:\n\\[\n\\dfrac{dx}{dt} = Ax\n\\]\nIf the matrix \\(A\\) is diagonalizable, we can decompose the matrix as:\n\\[\nA = Q \\Lambda Q^{-1}\n\\]\nWe define a new system of equations, by changing the variables:\n\\[\ny = Q^{-1}x\\quad x = Q y\n\\]\nThen, by chain rule:\n\\[\n\\dfrac{dy}{dt} = Q^{-1} \\dfrac{d x}{dt} = Q^{-1}Q \\Lambda Q^{-1} x= \\Lambda Q^{-1} x = \\Lambda y\n\\]\nWe have decoupled all equations: now the \\(y_i\\) grow or decline independently of each other.\n\\[\n\\dfrac{dy_i}{dt} = \\lambda_i y_i\n\\]\nThis is in fact the equation for the exponential growth/decay, with solution \\(y_i(t) = y(0) e^{\\lambda_i t}\\).\nWe can bring these solutions back to the original form:\n\\[\ny(t) = e^{\\Lambda t} y(0)\n\\]\nwhere \\(e^\\Lambda t\\) is a diagonal matrix:\n\\[\ne^{\\Lambda t}= \\begin{pmatrix}\ne^{\\lambda_1 t} & 0 & \\cdots &0\\\\\n0 & e^{\\lambda_2 t} & \\cdots &0\\\\\n\\cdots & \\cdots & \\cdots & \\cdots\\\\\n0 & 0 & \\cdots & e^{\\lambda_n t}\\\\\n\\end{pmatrix}\n\\]\nThen:\n\\[\nx(t) = Q y(t) = Q e^{\\Lambda t} y(0) = Q e^{\\Lambda t} Q^{-1} x(0)\n\\]\nAllowing to easily compute the solution for any linear systems of ODEs.\nStability of the origin\nSuppose that \\(\\lambda_i\\) is a real, negative number; then \\(\\lim_{t \\to \\infty}e^{\\lambda_i t} = 0\\). If \\(\\lambda_i\\) is positive, on the other hand, then \\(\\lim_{t \\to \\infty}e^{\\lambda_i t} = \\infty\\). Thus, if any of the \\(\\lambda_i &gt; 0\\), the system will initially move toward \\(\\infty\\) in the direction specified by the corresponding eigenvector.\nWhenever \\(\\lambda_i\\) is complex (e.g., generically, when \\(A\\) is not symmetric), then we need to consider:\n\\[\ne^{\\alpha t + i \\beta t} = e^{\\alpha t} e^{i \\beta t} = e^{\\alpha t} (\\cos \\beta + i \\sin \\beta )t\n\\]\nwhere we have used Euler’s formula. Importantly, \\((\\cos \\beta + i \\sin \\beta )\\) is bounded, and in fact its real (imaginary) part is \\(\\leq 1\\) (the equation describes a unit circle in the complex plane). Then, \\(\\lim_{t \\to \\infty} e^{\\alpha t + i \\beta t} = 0\\) if \\(\\alpha &lt; 0\\).\nTherefore, the vector \\(0_n\\) is an asymptotically stable equilibrium of the system \\(\\dfrac{dx}{dt} = A x\\) if and only if all the eigenvalues of \\(A\\) have negative real part.\nStability of the origin for \\(A_{2 \\times 2}\\)\nAs we have shown above, the eigenvalues of a \\(2\\times2\\) matrix \\(A\\):\n\\[\nA = \\begin{pmatrix}\na & b\\\\\nc & d\n\\end{pmatrix}\n\\]\nare:\n\\[\n\\lambda = \\dfrac{a + d \\pm \\sqrt{4bc + (a-d)^2}}{2}\n\\]\nWe can rewrite the values as:\n\\[\n\\lambda = \\dfrac{1}{2} \\left(\\text{Tr}A \\pm\\sqrt{\\left(\\text{Tr}A \\right)^2 - 4 \\det A} \\right)\n\\]\nIf the trace is negative, and the determinant positive, then the eigenvalues have negative real part, and thus the origin is stable for the corresponding system of linear ODEs. In fact, knowing the trace and the determinant is in this case sufficient to determine the type of dynamics around equilibrium:\n\n\n\nCharacterizing dynamics using trace and determinant\n\n\n\n\n\nTo probe the local asymptotic stability of the equilibria, we can:\n\nCalculate the Jacobian matrix, \\(J\\)\nPlug in an equilibrium, obtaining the corresponding community matrix \\(M\\)\nCompute the eigenvalues of \\(M\\), \\(\\lambda_i\\)\nIf all the eigenvalues have negative real part, \\(\\Re (\\lambda_i) &lt; 0\\), then the equilibrium is locally asymptotically stable; if any \\(\\Re (\\lambda_i) &gt; 0\\), then the equilibrium is unstable, and there are small perturbations that will amplify (at least initially)\n\nFor the GLV system with equilibrium \\(x^\\star = -A^{-1}r &gt; 0_n\\), we have:\n\\[\nJ_{ii} = \\dfrac{\\partial (r_i x_i + \\sum_j A_{ij} x_i x_j)}{\\partial x_i}  = r_i + \\sum_j A_{ij} x_j + A_{ii} x_i\n\\]\nAt equilibrium, we have:\n\\[\nr_i + \\sum_j A_{ij} x_j^\\star = 0\n\\]\nand therefore\n\\[\nM_{ii} = \\left. J_{ii} \\right|_{x^\\star} = A_{ii} x_i^\\star\n\\]\nSimilarly,\n\\[\nJ_{ii} = \\dfrac{\\partial (r_i x_i + \\sum_j A_{ij} x_i x_j)}{\\partial x_j}  = A_{ij} x_i\n\\]\nand thus\n\\[\nM_{ij} = \\left. J_{ij} \\right|_{x^\\star} = A_{ij} x_i^\\star\n\\]\nPutting them together, we obtain:\n\\[\nM = \\left. J \\right|_{x^\\star} = D(x^\\star)A\n\\]\nand thus the equilibrium is l.a.s. if and only if all of the eigenvalues of \\(D(x^\\star)A\\) have negative real part.\nIf the matrix \\(A\\) is symmetric, any feasible equilibrium is stable if and only if the eigenvalues of \\(A\\) are all negative (i.e., \\(A\\) is negative definite). To prove this, take \\(A = A^T\\) and consider the similarity transformation\n\\[\n\\begin{aligned}\nD(x^\\star)^{-\\frac{1}{2}} D(x^\\star) A D(x^\\star)^{\\frac{1}{2}}\\\\\nD(x^\\star)^{\\frac{1}{2}}  A D(x^\\star)^{\\frac{1}{2}}\\\\\n\\end{aligned}\n\\]\nThe matrices \\(D(x^\\star) A\\) and \\(D(x^\\star)^{\\frac{1}{2}} A D(x^\\star)^{\\frac{1}{2}}\\) are similar, and thus have the same eigenvalues; the matrices \\(A\\) and \\(D(x^\\star)^{\\frac{1}{2}} A D(x^\\star)^{\\frac{1}{2}}\\) are congruent, and thus have the same number of positive, negative and zero eigenvalues by Sylvester’s law of inertia.\nA symmetric matrix is negative definite if all its submatrices obtained by deleting a set of rows and the corresponding columns are negative definite as well. Then, if \\(A = A^T\\) is negative definite, a) a feasible equilibrium is locally stable, and b) for any subsystem, feasibility implies local stability.\nNote that this is generally not the case for nonsymmetric matrices \\(A\\), in which case we could have that \\(A\\) has all eigenvalues with a negative real part, while \\(D(x^\\star)A\\) has some eigenvalues with positive real part (or viceversa). For example, take\n\\[\nA = \\begin{pmatrix}\n-3 & 4 & 0\\\\\n5 & -2 & -2\\\\\n5 & 5 & -3\n\\end{pmatrix} \\quad \\lambda(A) = \\{-7,\\frac{1}{2}(-1 \\pm i \\sqrt{15}) \\}\n\\]\nand the equilibrium \\(x^\\star = (1,1,1/2)^T\\) (obtained for \\(r = (-1, -2, -17/2)\\)); we obtain:\n\\[\nM = D(x^\\star)A = \\begin{pmatrix}\n-3 & 4 & 0\\\\\n5 & -2 & -2\\\\\n\\frac{5}{2} & \\frac{5}{2} & -\\frac{3}{2}\n\\end{pmatrix} \\quad \\lambda(B) = \\{-7,\\frac{1}{4}(1 \\pm i\\sqrt{31}) \\}\n\\]\nThus, the equilibrium is not locally asymptotically stable."
  },
  {
    "objectID": "ch1.html#global-asymptotic-stability",
    "href": "ch1.html#global-asymptotic-stability",
    "title": "The Generalized Lotka-Volterra model",
    "section": "",
    "text": "In certain models, we can show that whenever all the populations start at a positive value, they will always reach a certain equilibrium \\(x^\\star\\). In this case, we say the equilibrium is globally asymptotically stable.\nBecause solving differential equations is in general very difficult, and in many cases of interest impossible, we employ a proxy function, called a Lyapunov function.\n\n\n\n\n\n\nLyapunov functions\n\n\n\n\n\nWe want to prove that all trajectories originating at \\(x(0) &gt; 0\\) eventually converge to \\(x^\\star\\). If we can find a function \\(V\\) such that:\n\n\\(V(x(t)) \\geq 0\\) for all \\(x(t) &gt; 0\\)\n\\(V(x(t)) = 0\\) if and only if \\(x(t) = x^\\star\\)\n\\(\\dfrac{d V(x(t))}{dt} \\leq 0\\) for all \\(x(t)\\) and\n\\(\\dfrac{d V(x(t))}{dt} = 0\\) if and only if \\(x(t) = x^\\star\\)\n\nthen \\(x^\\star\\) is globally asymptotically stable: all trajectories starting at a positive point will converge to it.\nThe logic of this procedure is to identify a suitable function \\(V\\) that is positive everywhere but at the equilibrium, and is always declining in time; then necessarily the function will eventually reach zero, which is attained only at equilibrium.\nExample\n\\(V(x(t)) = (x(t) - x^\\star)^2\\) is a Lyapunov function for the logistic growth model \\(dx/dt = x(1-x)\\): the model has an equilibrium \\(x^\\star = 1\\) that is globally asymptotically stable.\n\n\\(V(x(t))\\) is always nonnegative, and is zero only at \\(x(t) = x^\\star = 1\\)\nThe derivative of \\(V(x(t))\\) w.r.t. time is:\n\n\\[\n\\begin{aligned}\n\\dfrac{dV(t)}{dt} &= \\dfrac{dV(t)}{dx(t)}\\dfrac{dx(t)}{dt}\\\\\n&= 2(x(t) - x^\\star)\\dfrac{dx(t)}{dt}\\\\\n&=-2(x(t)-1) x(t)(x(t)-1)\\\\\n&=-2 x(t) (x(t)-1)^2 \\leq 0\n\\end{aligned}\n\\]\n\n\n\nThere are two classic candidate Lyapunov functions for Lotka-Volterra models. The first is due to MacArthur, and shows that, when interactions are symmetric and the matrix of interactions is negative definite (i.e., has only negative eigenvalues), the feasible equilibrium is globally stable.\nWe consider a slightly modified version of MacArthur’s function, and assume \\(A = A^T\\):\n\\[\nW(x) = r^Tx^\\star - (2 r^T x + x^T A x)\n\\]\nWhenever \\(A\\) is negative definite, then \\(W(x(t))\\) is positive everywhere but at equilibrium (the function is convex), and has a single minimum at the equilibrium. Note that, whenever \\(x^\\star &gt; 0_n\\) is an equilibrium, then\n\\[\n\\begin{aligned}\nr + A x^\\star &= 0_n\\\\\nr &= -Ax^\\star\n\\end{aligned}\n\\]\nSubstitute these values in the function \\(W\\), to obtain:\n\\[\n\\begin{aligned}\nW(x^\\star) &= r^Tx^\\star - (2 r^T x^\\star + (x^\\star)^T A x^\\star) \\\\\n&=r^Tx^\\star - (2 r^T x^\\star + ((x^\\star) A)^T x^\\star)\\\\\n&=r^Tx^\\star - (2 r^T x^\\star -r^T x^\\star)\\\\\n&=0_n\n\\end{aligned}\n\\]\nDifferentiating with respect to time, we find:\n\\[\n\\begin{aligned}\n\\dot{W}(x(t)) &= -(2 r^T \\dot{x} + \\dot{x}^T A x + x^T A \\dot{x})\\\\\n&= -(2 r^T \\dot{x} + \\dot{x}^T A^T x + x^T A \\dot{x})\\\\\n&= -2 (r + Ax)^T \\dot{x}\\\\\n&= -2 (r + Ax)^T D(x) (r + Ax)\\\\\n&=-2 \\sum_i x_i (r_i + (Ax)_i)^2 \\leq 0\n\\end{aligned}\n\\]\nA more general candidate Lyapunov function is due to Goh, and shows that, whenever there exists a positive diagonal matrix \\(D(w)\\) such that \\(D(w)A^T + AD(w)\\) is negative definite, then the equilibrium \\(x^\\star &gt; 0_n\\) is globally stable.\nWe start with the simplest case in which \\(w = 1_n\\) and thus \\(D(w) = I\\). Take the function\n\\[\nV(x(t)) = \\sum_i \\left(x_i - x_i^\\star - x_i^\\star \\log \\frac{x_i}{x_i^\\star} \\right)\n\\]\nThe function is positive for every \\(x \\in \\mathbb {R^n}_+\\), because \\(z - 1 - \\log z \\geq 0\\) whenever \\(z &gt; 0\\); take \\(z = x_i / {x_i}^\\star\\) and then multiply by \\({x_i}^\\star\\) to prove that the function is nonnegative.\nDifferentiating with respect to time, we find:\n\\[\n\\begin{aligned}\n\\dot{V}(x(t)) &= \\sum_i \\left(\\dot{x}_i - x_i^\\star \\frac{\\dot{x}_i}{x_i} \\right)\\\\\n&= \\sum_i \\left(x_i (r_i + (Ax)_i) - x_i^\\star (r_i + (Ax)_i)\\right)\\\\\n&=\\sum_i \\Delta x_i (-(Ax^\\star)_i + (Ax)_i )\\\\\n&=\\sum_{i,j}\\Delta x_i A_{ij} \\Delta x_j\\\\\n&=\\Delta x^T A \\Delta x\\\\\n&=\\frac{1}{2}\\Delta x^T (A + A^T)\\Delta x\\\\\n\\end{aligned}\n\\]\nThus, if the symmetric part of \\(A\\), \\(H(A) = \\frac{1}{2} (A + A^T)\\) is negative definite, then \\(\\dot{V}(x(t))&lt;0\\) for every \\(\\Delta x \\neq 0\\) and the equilibrium is stable.\nTo extend the reach of the candidate function, consider the change of variables:\n\\[\nz_i = x_i / w_i \\quad x_i = w_i z_i\n\\]\nwith \\(w_i&gt;0\\). This change of variables cannot impact the existence or stability of equilibria (we are simply changing the unit of measure we Then,\n\\[\n\\dot{z_i} = \\frac{\\dot{x}_i}{w_i} = \\frac{x_i}{w_i}(r_i + (Ax)_i) = z_i(r_i + (AD(w)z)_i)=z_i(r_i + (\\tilde{A}z)_i)\n\\]\nThus, if \\(H(\\tilde{A}) = \\frac{1}{2} (AD(w) + D(w)A^T)\\) is negative definite, the equilibrium is stable."
  },
  {
    "objectID": "ch1.html#global-stability-and-saturated-equilibria",
    "href": "ch1.html#global-stability-and-saturated-equilibria",
    "title": "The Generalized Lotka-Volterra model",
    "section": "",
    "text": "When Goh’s function holds, we can prove that dynamics starting from positive conditions \\(x(t)&gt;0_n\\) will converge to a saturated equilibrium \\(\\tilde{x}\\) characterized by two conditions. We have \\(n\\) populations, and at the saturated equilibrium the populations in set \\(k\\) coexist at a globally stable equilibrium, and the remaining populations, belonging to set \\(n-k\\) are extinct, and cannot re-invade the system starting from low abundance.\nWithout loss of generality, we can order the populations such that the first \\(\\|k\\|\\) populations are those that coexist at the saturated equilibrium, and the remaining \\(\\| n- k\\|\\) are those extinct at the saturated equilibrium. We partition all variables according to the two sets:\n\\[\nx = \\begin{pmatrix}\ny\\\\\nz\n\\end{pmatrix} \\quad \\tilde{x} = \\begin{pmatrix}\ny^\\star\\\\\n0_{n-k}\n\\end{pmatrix} \\quad A = \\begin{pmatrix}\n\\mathfrak A & \\mathfrak B\\\\\n\\mathfrak C & \\mathfrak D\n\\end{pmatrix}\\quad r = \\begin{pmatrix}\n\\mathfrak r\\\\\n\\mathfrak s\n\\end{pmatrix}\n\\]\nWe consider a minor modification of Goh’s function:\n\\[\nV(x (t)) = \\sum_{i \\in k} \\left(y_i - y_i^\\star - y_i^\\star \\log \\frac{y_i}{y_i^\\star} \\right) +\n\\sum_{i \\in n-k} z_i\n\\]\nDifferentiating with respect to time, we obtain:\n\\[\n\\begin{aligned}\n\\dot{V}(x(t)) &= \\sum_{i \\in k} \\left(\\dot{y}_i - y_i^\\star \\frac{\\dot{y}_i}{y_i} \\right)+\\sum_{i \\in n-k} \\dot{z}_i\\\\\n&=\\Delta y^T(\\mathfrak r + \\mathfrak A y + \\mathfrak Bz) + z^T(\\mathfrak s + \\mathfrak C y+ \\mathfrak D z)\n\\end{aligned}\n\\]\nNow we substitute \\(\\mathfrak r = -\\mathfrak A y^\\star\\), and add and subtract \\(z^T \\mathfrak C y^\\star\\):\n\\[\n\\begin{aligned}\n\\dot{V}(x(t)) &=\\Delta y^T(-\\mathfrak A y^\\star + \\mathfrak A y + \\mathfrak Bz) + z^T(\\mathfrak s + \\mathfrak C y+ \\mathfrak D z  + \\mathfrak C y^\\star - \\mathfrak C y^\\star)\\\\\n&=\\Delta y^T(\\mathfrak A \\Delta y + \\mathfrak Bz) + z^T(\\mathfrak s + \\mathfrak C \\Delta y+ \\mathfrak D z  + \\mathfrak C y^\\star)\n\\end{aligned}\n\\] Now we write the function as the sum of two parts:\n\\[\n\\begin{aligned}\n\\dot{V}(x(t)) &= (\\Delta y^T \\mathfrak A \\Delta y + \\Delta y^T \\mathfrak B z + z^T \\mathfrak C \\Delta y + z^T \\mathfrak D z) + z^T(s + \\mathfrak C y^\\star)\\\\\n&= \\begin{pmatrix}\n\\Delta y\\\\\nz\n\\end{pmatrix}^T \\begin{pmatrix}\n\\mathfrak A & \\mathfrak B\\\\\n\\mathfrak C & \\mathfrak D\n\\end{pmatrix}\\begin{pmatrix}\n\\Delta y\\\\\nz\n\\end{pmatrix}+ z^T(s + \\mathfrak C y^\\star)\\\\\\\\\n&= \\begin{pmatrix}\n\\Delta y\\\\\nz\n\\end{pmatrix}^T A\\begin{pmatrix}\n\\Delta y\\\\\nz\n\\end{pmatrix}+ z^T(s + \\mathfrak C y^\\star)\\\\\\\\\n\\end{aligned}\n\\]\nWhenever \\(H(A) = \\frac{1}{2}(A + A^T)\\) is negative definite, then the first term is negative for any choice of \\(y\\) and \\(z\\). Examining the second term, we see that \\(\\mathfrak s + \\mathfrak C y^\\star\\) measures the invasion growth rate of the populations in the set \\(n-k\\) when they are attempting to invade the community that is resting at \\(y^\\star\\). Thus, if we can find a saturated equilibrium, it is globally stable and will be reached for any \\(x(0) &gt; 0_n\\)."
  },
  {
    "objectID": "ch1.html#classic-papers-references-and-further-readings",
    "href": "ch1.html#classic-papers-references-and-further-readings",
    "title": "The Generalized Lotka-Volterra model",
    "section": "",
    "text": "A brief paper discussing how to build models in biology:\n\nRichard Levins, 1966. The strategy of model building in population biology. American Scientist 54:421-431\n\nThe Lotka-Volterra predator-prey model was discovered independently by Alfred J. Lotka and Vito Volterra:\n\nAlfred J. Lotka, 1920. Analytical Note on Certain Rhythmic Relations in Organic Systems. PNAS 6 (7) 410-415\nVito Volterra, 1926. Fluctuations in the Abundance of a Species Considered Mathematically. Nature 118:558-60\n\nYou can read their exchange here.\nThe constant of motion that underlies the candidate Lyapunov functions was derived by Lotka in 1920:\n\nAlfred J. Lotka, 1920. Undamped oscillations derived from the law of mass action. Journal of the American Chemical Society 42:1595-1599\n\nVolterra considered many variations, including the competition between species. His results caught the eye of an experimentalist, who validated the principle of competitive exclusion using protozoans:\n\nG.F. Gause, 1934. Experimental Analysis of Vito Volterra’s Mathematical Theory of the Struggle for Existence. Science 79:16-17\n\nThe paper by MacArthur, on consumer-resource dynamics:\n\nR. MacArthur, 1970. Species packing and competitive equilibrium for many species. Theoretical population biology, 1(1), pp.1-11.\n\nThe paper by B.S. Goh on global stability:\n\nB.S. Goh, 1977. Global stability in many-species systems. The American Naturalist, 111(977), pp.135-143.\n\nThe convergence to saturated equilibria has strong implications for ecological assembly. See for example:\n\nJ. Hofbauer, S.J. Schreiber, 2022. Permanence via invasion graphs: incorporating community assembly into modern coexistence theory. Journal of mathematical biology. Nov;85(5):54.\nC.A. Serván, S. Allesina, 2021. Tractable models of ecological assembly. Ecology Letters May;24(5):1029-37.\n\nI have recently written a paper on Lyapunov functions for GLV that extends and generalizes Goh’s function. Ask me about it if you want to know more!\n\nS. Allesina, 2025. Global stability of ecological and evolutionary dynamics via equivalence. In review"
  },
  {
    "objectID": "ch2.html",
    "href": "ch2.html",
    "title": "GLV with random parameters",
    "section": "",
    "text": "Suppose we take \\(n\\) populations, each growing according to:\n\\[\n\\dot{x}_i = x_i (r_i - A_{ii} x_i)\n\\]\nwith \\(A_{ii} &gt; 0\\). We assume that \\(r_i \\sim Q\\), a distribution with mean \\(0\\), \\(\\mathbb E(r_i) = 0\\) and symmetric about its mean: \\(P(r_i) = P(-r_i)\\). For example, we could choose \\(r_i \\sim \\mathcal N(0, \\sigma^2)\\), or \\(r_i \\sim \\mathcal U[-1, 1]\\). Naturally, whenever \\(r_i &gt; 0\\), the population will grow to \\(x_i^\\star = r_i / A_{ii}\\). If \\(r_i &lt; 0\\), on the other hand, the population will go extinct. Because of the symmetry around zero, each population has therefore probability \\(1/2\\) of persisting. When we have \\(n\\) populations, the number of coexisting populations \\(\\|k\\|\\) is a random variable following the binomial distribution:\n\\[\nP(\\|k\\| | n) = \\binom{n}{\\|k\\|} \\frac{1}{2^n}\\quad \\|k\\| \\sim \\mathcal B\\left(n, \\frac{1}{2}\\right)\n\\]\n\n\n\nNow consider a GLV model with random parameters. We choose \\(r_i\\) from a distribution with mean zero and symmetric about the mean, and each interaction \\(A_{ij}\\) from a distribution with mean zero and symmetric about the mean. Moreover, we add a constant to the diagonal of the matrix such that the symmetric part of \\(A\\), \\(H(A) = \\frac{1}{2} (A + A^T)\\) is positive definite. As we have seen before, this means that dynamics will always converge to a saturated equilibrium.\nWe now introduce a family of \\(2^n\\) matrices \\(S_i\\), with:\n\\[\n\\begin{aligned}\nS_1 &= \\begin{pmatrix}\n1 & 0 & 0 & \\cdots & 0\\\\\n0 & 1 & 0 & \\cdots & 0\\\\\n0 & 0 & 0 & \\cdots & 0\\\\\n\\vdots & \\vdots & \\vdots &\\ddots &\\vdots\\\\\n0 & 0 & 0 & 0 &1\n\\end{pmatrix} = I_n\\\\\nS_2 &= \\begin{pmatrix}\n-1 & 0 & 0 & \\cdots & 0\\\\\n0 & 1 & 0 & \\cdots & 0\\\\\n0 & 0 & 1 & \\cdots & 0\\\\\n\\vdots & \\vdots & \\vdots &\\ddots &\\vdots\\\\\n0 & 0 & 0 & 0 &1\n\\end{pmatrix} \\\\\nS_3 &= \\begin{pmatrix}\n1 & 0 & 0 & \\cdots & 0\\\\\n0 & -1 & 0 & \\cdots & 0\\\\\n0 & 0 & 1 & \\cdots & 0\\\\\n\\vdots & \\vdots & \\vdots &\\ddots &\\vdots\\\\\n0 & 0 & 0 & 0 &1\n\\end{pmatrix} \\\\\nS_4 &= \\begin{pmatrix}\n-1 & 0 & 0 & \\cdots & 0\\\\\n0 & -1 & 0 & \\cdots & 0\\\\\n0 & 0 & 1 & \\cdots & 0\\\\\n\\vdots & \\vdots & \\vdots &\\ddots &\\vdots\\\\\n0 & 0 & 0 & 0 &1\n\\end{pmatrix}\\\\\n\\vdots\\\\\nS_{2^n} &= \\begin{pmatrix}\n-1 & 0 & 0 & \\cdots & 0\\\\\n0 & -1 & 0 & \\cdots & 0\\\\\n0 & 0 & -1 & \\cdots & 0\\\\\n\\vdots & \\vdots & \\vdots &\\ddots &\\vdots\\\\\n0 & 0 & 0 & 0 &-1\n\\end{pmatrix} = -I_n\\\\\n\\end{aligned}\n\\]\nThese matrices, called signature matrices are their own inverse (a matrix with this property is called involutory), and therefore, we have that \\(S_i S_i = S_i^2 = I_n\\). Geometrically, they represent a reflection in each of the axes corresponding to the negated rows or columns.\nWe then consider what happens when we transform the parameters by multiplying them by \\(S_i\\). Take an arbitrary GLV system, and solve for the \\(x\\) that makes \\(r + Ax = 0_n\\):\n\\[\nx = -A^{-1} r\n\\]\nThe vector is a feasible equilibrium for the system if \\(x &gt; 0_n\\). Now consider the transformed system:\n\\[\nr' = S_i r \\quad A' = S_iAS_i\n\\]\nNote that \\(A'\\) is similar to \\(A\\), and therefore has the same eigenvalues; moreover, \\(P(r') = P(r)\\) and \\(P(A') = P(A)\\), because of symmetry. Now compute the new solution\n\\[\n\\begin{aligned}\nx' &= -(S_iAS_i)^{-1} S_i r\\\\ &=-S_iA^{-1}S_i S_i r\\\\\n&=-S_iA^{-1}r\\\\\n&=-S_i x\n\\end{aligned}\n\\]\nThat is, the transformation changes the sign of the components of \\(x\\) corresponding to the negative coefficients in \\(S_i\\). Hence, for any possible choice of \\(r\\) and \\(A\\), there is only one possible choice of \\(S_i\\) that makes the equilibrium feasible. Because all matrices \\(A'\\) and all vectors \\(r'\\) have the same probability/density, then the probability of having a positive \\(x\\) is exactly \\(1/2^n\\). Thus, a system with random parameters and a strongly stable matrix of interactions has the same probability of feasibility as that of a system in which populations are not interacting!\nWe have seen that when \\(A\\) is such that \\(H(A)\\) is negative definite, dynamics always converge to a saturated equilibrium. We want to compute the probability of finding a saturated equilibrium, in which populations belonging to set \\(k\\) coexist, and the remaining populations cannot invade when rare.\nWe thus divide \\(x\\), \\(r\\) and \\(A\\) as:\n\\[\nx = \\begin{pmatrix}\ny\\\\\nz\n\\end{pmatrix} \\quad \\tilde{x} = \\begin{pmatrix}\ny^\\star\\\\\n0_{\\|n-k\\|}\n\\end{pmatrix} \\quad A = \\begin{pmatrix}\n\\mathfrak A & \\mathfrak B\\\\\n\\mathfrak C & \\mathfrak D\n\\end{pmatrix}\\quad r = \\begin{pmatrix}\n\\mathfrak r\\\\\n\\mathfrak s\n\\end{pmatrix}\n\\]\nWe also divide \\(S_i\\) into:\n\\[\nS_i = \\begin{pmatrix}\nS_{i}^{(k)} & 0_{\\|k\\|, \\|n-k\\|}\\\\\n0_{\\|n-k\\|, \\|n\\|} & S_{i}^{(n-k)}\n\\end{pmatrix}\n\\]\nWhen we use the signature matrix, the vector \\(\\mathfrak s\\) and the matrix \\(\\mathfrak C\\) become:\n\\[\n\\mathfrak s' = S_i^{(n-k)} \\mathfrak s\\quad \\mathfrak C' = S_i^{(n-k)} \\mathfrak C S_i^{(k)}\n\\] The feasibility and nonivasibility condition, for a given choice of \\(S_i\\) read:\n\\[\n\\begin{cases}\ny' = S_i^{(k)} (-\\mathfrak A^{-1}\\mathfrak r)\\\\\nS_i^{(n-k)}(\\mathfrak s + \\mathfrak C y') &lt; 0_{\\|n-k\\|}\\\\\n\\end{cases}\n\\]\nThere is only one choice out of \\(2^{\\|k\\|}\\) that makes \\(y' &gt; 0_{\\|k\\|}\\); moreover, there is only one choice of \\(S_i^{(n-k)}\\) that fulfills the noninvasibility condition, out of \\(2^{\\|n-k\\|}\\) equiprobable choices. Then, we have that the probability of finding exactly \\(\\|k\\|\\) populations coexisting at the saturated equilibrium, with the remaining \\(\\|n-k\\|\\) that cannot invade is exactly \\(1/2^{\\|k\\|} \\cdot 2^{\\|n-k\\|} = 1/2^n\\). The number of coexisting populations at the saturated equilibrium follows the binomial distribution:\n\\[\nP(\\|k\\| | n) = \\binom{n}{\\|k\\|} \\frac{1}{2^n}\\quad \\|k\\| \\sim \\mathcal B\\left(n, \\frac{1}{2}\\right)\n\\]\nexactly as for the non-interacting case.\n\n\n\n\n\n\nWe now consider a more complicated case, in which we have a competitive GLV system:\n\\[\n\\dot{x}_i=x_i r_i \\left(1-\\sum_j M_{ij}x_j\\right)\n\\]\nwhere the matrix of interactions is given by the sum of two matrices:\n\\[\nM = \\alpha I + B\n\\]\nand \\(B\\) is a random matrix, with entries sampled independently from a distribution with mean \\(\\mu &gt; 0\\), and unit variance. We want to calculate the probability that the system has a feasible equilibrium, and how the probability changes when we increase \\(\\alpha\\).\nThe value of \\(\\alpha &gt; 0\\) can be considered the “excess” intraspecific interaction in the system. To show that this value influences feasibility, we start by showing that a sufficiently large \\(\\alpha\\) guarantees feasibility.\n\n\n\nWe have taken \\(M = \\alpha I + B\\); call \\(m\\) the vector of column means of \\(B\\). Here we show that, as long as \\(m &gt; 0_n\\), its actual value has no effect on feasibility. We can write\n\\[\nM = \\alpha I + B = \\alpha I + 1_n m^T + C\n\\]\nwhere \\(C\\) has columns summing to zero (\\(1_n^T C = 0_n^T\\)). For feasibility, we need the solution:\n\\[\n\\begin{aligned}\nMx &= 1_n\\\\\nx &= M^{-1}1_n &gt; 0\n\\end{aligned}\n\\]\nWe consider the simpler system:\n\\[\n\\begin{aligned}\n(\\alpha I + C)y &= 1_n\\\\\ny &=(\\alpha I + C)^{-1}1_n\n\\end{aligned}\n\\] and consider the solution \\(x\\) to be the solution of a rank-1 update of the system in \\(y\\).\n\n\n\n\n\n\nSherman-Morrison formula\n\n\n\n\n\nSuppose that \\(A + uv^T\\) is invertible, where \\(A\\) is a \\(n\\times n\\) matrix, and \\(u\\) and \\(v\\) are column vectors of size \\(n\\). The matrix is invertible as long as \\(1 + v^T A^{-1}u \\neq 0\\).\nIf this is the case\n\\[\n(A + u v^T)^{-1} = A^{-1} - \\frac{1}{1 + v^T A^{-1}u} A^{-1} u v^T A^{-1}\n\\]\nThis formula is useful when we need to update the matrix inverse after a rank-1 perturbation.\n\n\n\nUsing the Sherman-Morrison formula, we obtain:\n\\[\n\\begin{aligned}\nx &= ((\\alpha I + C) + 1_n m^T)^{-1}1_n\\\\\n&= \\left((\\alpha I + C)^{-1}  - \\frac{1}{1 + m^T ((\\alpha I + C)^{-1}) 1_n} (\\alpha I + C)^{-1} 1_n m^T (\\alpha I + C)^{-1}\\right) 1_n\\\\\n&= y - \\frac{1}{1 + m^Ty} y m^T y\\\\\n&= \\frac{1}{1 + m^T y} y\n\\end{aligned}\n\\]\nThus, \\(x\\) and \\(y\\) are proportional to each other, with constant of proportionality \\(1 / (1 + m^T y)\\). Then \\(x &gt; 0_n\\) when either a) \\(y &gt; 0_n\\), and \\(1 + m^T y &gt; 0\\), or b) \\(y &lt; 0_n\\) and \\(1 + m^T y &lt; 0\\). Sum the equations in \\(y\\):\n\\[\n\\begin{aligned}\n1_n^T (\\alpha I + C) y &= 1_n^T 1_n\\\\\n\\alpha 1_n^T y &=n\\\\\n\\frac{1}{n} 1_n^T y &= \\frac{1}{\\alpha}\n\\end{aligned}\n\\]\nThis means that \\(y\\) cannot be all negative; then given that for \\(y&gt;0_n\\) and \\(m &gt; 0_n\\) we have \\(1 + m^Ty &gt; 0\\), we have that \\(x\\) is feasible if and only if \\(y\\) is feasible.\nThis means that any matrix that can be written as \\(B = C + 1m^T\\) with \\(m &gt; 0_n\\) belongs to the same class for feasibility—the exact value of \\(m\\) does not matter.\n\n\n\nWe want to show that the system of equations\n\\[\n(\\alpha I + C)y = 1_n\n\\]\nhas a positive solution \\(y &gt; 0_n\\) for \\(\\alpha\\) large enough. To this end, we first divide both sides by \\(\\alpha &gt; 0\\):\n\\[\n\\left(I + \\frac{1}{\\alpha} C\\right)y = \\frac{1}{\\alpha} 1_n\n\\]\nWe have seen above that \\(\\alpha 1_n^T y/n = 1\\); we multiply the r.h.s. by this value, obtaining:\n\\[\n\\begin{aligned}\n\\left(I + \\frac{1}{\\alpha} C\\right)y &= \\frac{1}{\\alpha} 1_n \\frac{\\alpha}{n} 1_n^Ty\\\\\n\\left(\\frac{1}{\\alpha} C\\right)y  + y&= \\frac{1}{n} 1_n1_n^Ty\\\\\\\\\n\\left(\\frac{1}{n} 1_n1_n^T - \\frac{1}{\\alpha} C\\right)y &= y\n\\end{aligned}\n\\]\nThus, we have that \\(y\\) is a right eigenvector of matrix \\(\\frac{1}{n} 1_n1_n^T - \\frac{1}{\\alpha} C\\), associated with \\(\\lambda = 1\\).\n\n\n\n\n\n\nPerron-Frobenius theorem\n\n\n\n\n\nThe matrix \\(A\\) has all coefficients positive \\(A_{ij} &gt; 0\\, \\forall i,j\\).\nThen the matrix has a single positive real eigenvalue \\(\\rho\\) (spectral radius, or Perron root) such that \\(|\\lambda_i| &lt; \\rho\\) for all other eigenvalues. Moreover, the eigenvalue is associated with an eigenvectors that can be made all positive (Perron eigenvector).\n\n\n\nIf we choose \\(\\alpha = \\alpha_\\infty\\) such that \\(C_{ij} / \\alpha_\\infty &lt; 1/n\\), then the matrix \\(\\frac{1}{n} 1_n1_n^T - \\frac{1}{\\alpha_\\infty} C\\) has only positive coefficients; moreover all columns sum to unity and therefore the spectral radius is \\(\\rho = 1\\). Because of Perron-Frobenius theorem, \\(y &gt; 0_n\\).\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nThe Lotka-Volterra predator-prey model was discovered independently by Alfred J. Lotka and Vito Volterra:\n\nAlfred J. Lotka, 1920. Analytical Note on Certain Rhythmic Relations in Organic Systems. PNAS 6 (7) 410-415\nVito Volterra, 1926. Fluctuations in the Abundance of a Species Considered Mathematically. Nature 118:558-60\n\nYou can read their exchange here.\nThe constant of motion was derived by Lotka in 1920:\n\nAlfred J. Lotka, 1920. Undamped oscillations derived from the law of mass action. Journal of the American Chemical Society 42:1595-1599\n\nVolterra considered many variations, including the competition between species. His results caught the eye of an experimentalist, who validated the principle of competitive exclusion using protozoans:\n\nG.F. Gause, 1934. Experimental Analysis of Vito Volterra’s Mathematical Theory of the Struggle for Existence. Science 79:16-17\n\nThe analysis of two-species competitive Lotka-Volterra inspired the so-called Modern Coexistence Theory:\n\nChesson, P. 2000. Mechanisms of Maintenance of Species Diversity. Annual Review of Ecology and Systematics 31:343-366\n\nOn functional responses:\n\nCrawford S. Holling, 1959. Some Characteristics of Simple Types of Predation and Parasitism. The Canadian Entomologist 91:385-398\n\nThe paper proposing the paradox of enrichment:\n\nRosenzweig, Michael, 1971. The Paradox of Enrichment. Science 171: 385–387\n\nMore on limit cycles in predator-prey systems:\n\nRobert M. May, 1972. Limit Cycles in Predator-Prey Communities Science 177:900-902\nMichael E. Gilpin, 1972. Enriched Predator-Prey Systems: Theoretical Stability Science 177:902-904\n\nThe Nicholson-Bailey model:\n\nA.J. Nicholson, V.A. Bailey, 1935. The Balance of Animal Populations. Part I. Proceedings of the Zoological Society of London. 105: 551–598\n\nand its spatial version:\n\nH.N. Comins, M.P. Hassell, R.M. May, 1992. The Spatial Dynamics of Host–Parasitoid Systems. Journal of Animal Ecology 61:735-748"
  },
  {
    "objectID": "ch2.html#all-species-growing-logistically",
    "href": "ch2.html#all-species-growing-logistically",
    "title": "GLV with random parameters",
    "section": "",
    "text": "Suppose we take \\(n\\) populations, each growing according to:\n\\[\n\\dot{x}_i = x_i (r_i - A_{ii} x_i)\n\\]\nwith \\(A_{ii} &gt; 0\\). We assume that \\(r_i \\sim Q\\), a distribution with mean \\(0\\), \\(\\mathbb E(r_i) = 0\\) and symmetric about its mean: \\(P(r_i) = P(-r_i)\\). For example, we could choose \\(r_i \\sim \\mathcal N(0, \\sigma^2)\\), or \\(r_i \\sim \\mathcal U[-1, 1]\\). Naturally, whenever \\(r_i &gt; 0\\), the population will grow to \\(x_i^\\star = r_i / A_{ii}\\). If \\(r_i &lt; 0\\), on the other hand, the population will go extinct. Because of the symmetry around zero, each population has therefore probability \\(1/2\\) of persisting. When we have \\(n\\) populations, the number of coexisting populations \\(\\|k\\|\\) is a random variable following the binomial distribution:\n\\[\nP(\\|k\\| | n) = \\binom{n}{\\|k\\|} \\frac{1}{2^n}\\quad \\|k\\| \\sim \\mathcal B\\left(n, \\frac{1}{2}\\right)\n\\]"
  },
  {
    "objectID": "ch2.html#the-random-zoo",
    "href": "ch2.html#the-random-zoo",
    "title": "GLV with random parameters",
    "section": "",
    "text": "Now consider a GLV model with random parameters. We choose \\(r_i\\) from a distribution with mean zero and symmetric about the mean, and each interaction \\(A_{ij}\\) from a distribution with mean zero and symmetric about the mean. Moreover, we add a constant to the diagonal of the matrix such that the symmetric part of \\(A\\), \\(H(A) = \\frac{1}{2} (A + A^T)\\) is positive definite. As we have seen before, this means that dynamics will always converge to a saturated equilibrium.\nWe now introduce a family of \\(2^n\\) matrices \\(S_i\\), with:\n\\[\n\\begin{aligned}\nS_1 &= \\begin{pmatrix}\n1 & 0 & 0 & \\cdots & 0\\\\\n0 & 1 & 0 & \\cdots & 0\\\\\n0 & 0 & 0 & \\cdots & 0\\\\\n\\vdots & \\vdots & \\vdots &\\ddots &\\vdots\\\\\n0 & 0 & 0 & 0 &1\n\\end{pmatrix} = I_n\\\\\nS_2 &= \\begin{pmatrix}\n-1 & 0 & 0 & \\cdots & 0\\\\\n0 & 1 & 0 & \\cdots & 0\\\\\n0 & 0 & 1 & \\cdots & 0\\\\\n\\vdots & \\vdots & \\vdots &\\ddots &\\vdots\\\\\n0 & 0 & 0 & 0 &1\n\\end{pmatrix} \\\\\nS_3 &= \\begin{pmatrix}\n1 & 0 & 0 & \\cdots & 0\\\\\n0 & -1 & 0 & \\cdots & 0\\\\\n0 & 0 & 1 & \\cdots & 0\\\\\n\\vdots & \\vdots & \\vdots &\\ddots &\\vdots\\\\\n0 & 0 & 0 & 0 &1\n\\end{pmatrix} \\\\\nS_4 &= \\begin{pmatrix}\n-1 & 0 & 0 & \\cdots & 0\\\\\n0 & -1 & 0 & \\cdots & 0\\\\\n0 & 0 & 1 & \\cdots & 0\\\\\n\\vdots & \\vdots & \\vdots &\\ddots &\\vdots\\\\\n0 & 0 & 0 & 0 &1\n\\end{pmatrix}\\\\\n\\vdots\\\\\nS_{2^n} &= \\begin{pmatrix}\n-1 & 0 & 0 & \\cdots & 0\\\\\n0 & -1 & 0 & \\cdots & 0\\\\\n0 & 0 & -1 & \\cdots & 0\\\\\n\\vdots & \\vdots & \\vdots &\\ddots &\\vdots\\\\\n0 & 0 & 0 & 0 &-1\n\\end{pmatrix} = -I_n\\\\\n\\end{aligned}\n\\]\nThese matrices, called signature matrices are their own inverse (a matrix with this property is called involutory), and therefore, we have that \\(S_i S_i = S_i^2 = I_n\\). Geometrically, they represent a reflection in each of the axes corresponding to the negated rows or columns.\nWe then consider what happens when we transform the parameters by multiplying them by \\(S_i\\). Take an arbitrary GLV system, and solve for the \\(x\\) that makes \\(r + Ax = 0_n\\):\n\\[\nx = -A^{-1} r\n\\]\nThe vector is a feasible equilibrium for the system if \\(x &gt; 0_n\\). Now consider the transformed system:\n\\[\nr' = S_i r \\quad A' = S_iAS_i\n\\]\nNote that \\(A'\\) is similar to \\(A\\), and therefore has the same eigenvalues; moreover, \\(P(r') = P(r)\\) and \\(P(A') = P(A)\\), because of symmetry. Now compute the new solution\n\\[\n\\begin{aligned}\nx' &= -(S_iAS_i)^{-1} S_i r\\\\ &=-S_iA^{-1}S_i S_i r\\\\\n&=-S_iA^{-1}r\\\\\n&=-S_i x\n\\end{aligned}\n\\]\nThat is, the transformation changes the sign of the components of \\(x\\) corresponding to the negative coefficients in \\(S_i\\). Hence, for any possible choice of \\(r\\) and \\(A\\), there is only one possible choice of \\(S_i\\) that makes the equilibrium feasible. Because all matrices \\(A'\\) and all vectors \\(r'\\) have the same probability/density, then the probability of having a positive \\(x\\) is exactly \\(1/2^n\\). Thus, a system with random parameters and a strongly stable matrix of interactions has the same probability of feasibility as that of a system in which populations are not interacting!\nWe have seen that when \\(A\\) is such that \\(H(A)\\) is negative definite, dynamics always converge to a saturated equilibrium. We want to compute the probability of finding a saturated equilibrium, in which populations belonging to set \\(k\\) coexist, and the remaining populations cannot invade when rare.\nWe thus divide \\(x\\), \\(r\\) and \\(A\\) as:\n\\[\nx = \\begin{pmatrix}\ny\\\\\nz\n\\end{pmatrix} \\quad \\tilde{x} = \\begin{pmatrix}\ny^\\star\\\\\n0_{\\|n-k\\|}\n\\end{pmatrix} \\quad A = \\begin{pmatrix}\n\\mathfrak A & \\mathfrak B\\\\\n\\mathfrak C & \\mathfrak D\n\\end{pmatrix}\\quad r = \\begin{pmatrix}\n\\mathfrak r\\\\\n\\mathfrak s\n\\end{pmatrix}\n\\]\nWe also divide \\(S_i\\) into:\n\\[\nS_i = \\begin{pmatrix}\nS_{i}^{(k)} & 0_{\\|k\\|, \\|n-k\\|}\\\\\n0_{\\|n-k\\|, \\|n\\|} & S_{i}^{(n-k)}\n\\end{pmatrix}\n\\]\nWhen we use the signature matrix, the vector \\(\\mathfrak s\\) and the matrix \\(\\mathfrak C\\) become:\n\\[\n\\mathfrak s' = S_i^{(n-k)} \\mathfrak s\\quad \\mathfrak C' = S_i^{(n-k)} \\mathfrak C S_i^{(k)}\n\\] The feasibility and nonivasibility condition, for a given choice of \\(S_i\\) read:\n\\[\n\\begin{cases}\ny' = S_i^{(k)} (-\\mathfrak A^{-1}\\mathfrak r)\\\\\nS_i^{(n-k)}(\\mathfrak s + \\mathfrak C y') &lt; 0_{\\|n-k\\|}\\\\\n\\end{cases}\n\\]\nThere is only one choice out of \\(2^{\\|k\\|}\\) that makes \\(y' &gt; 0_{\\|k\\|}\\); moreover, there is only one choice of \\(S_i^{(n-k)}\\) that fulfills the noninvasibility condition, out of \\(2^{\\|n-k\\|}\\) equiprobable choices. Then, we have that the probability of finding exactly \\(\\|k\\|\\) populations coexisting at the saturated equilibrium, with the remaining \\(\\|n-k\\|\\) that cannot invade is exactly \\(1/2^{\\|k\\|} \\cdot 2^{\\|n-k\\|} = 1/2^n\\). The number of coexisting populations at the saturated equilibrium follows the binomial distribution:\n\\[\nP(\\|k\\| | n) = \\binom{n}{\\|k\\|} \\frac{1}{2^n}\\quad \\|k\\| \\sim \\mathcal B\\left(n, \\frac{1}{2}\\right)\n\\]\nexactly as for the non-interacting case."
  },
  {
    "objectID": "ch2.html#competitive-glv",
    "href": "ch2.html#competitive-glv",
    "title": "GLV with random parameters",
    "section": "",
    "text": "We now consider a more complicated case, in which we have a competitive GLV system:\n\\[\n\\dot{x}_i=x_i r_i \\left(1-\\sum_j M_{ij}x_j\\right)\n\\]\nwhere the matrix of interactions is given by the sum of two matrices:\n\\[\nM = \\alpha I + B\n\\]\nand \\(B\\) is a random matrix, with entries sampled independently from a distribution with mean \\(\\mu &gt; 0\\), and unit variance. We want to calculate the probability that the system has a feasible equilibrium, and how the probability changes when we increase \\(\\alpha\\).\nThe value of \\(\\alpha &gt; 0\\) can be considered the “excess” intraspecific interaction in the system. To show that this value influences feasibility, we start by showing that a sufficiently large \\(\\alpha\\) guarantees feasibility."
  },
  {
    "objectID": "ch2.html#effect-of-average-interaction-strength-on-feasibility",
    "href": "ch2.html#effect-of-average-interaction-strength-on-feasibility",
    "title": "GLV with random parameters",
    "section": "",
    "text": "We have taken \\(M = \\alpha I + B\\); call \\(m\\) the vector of column means of \\(B\\). Here we show that, as long as \\(m &gt; 0_n\\), its actual value has no effect on feasibility. We can write\n\\[\nM = \\alpha I + B = \\alpha I + 1_n m^T + C\n\\]\nwhere \\(C\\) has columns summing to zero (\\(1_n^T C = 0_n^T\\)). For feasibility, we need the solution:\n\\[\n\\begin{aligned}\nMx &= 1_n\\\\\nx &= M^{-1}1_n &gt; 0\n\\end{aligned}\n\\]\nWe consider the simpler system:\n\\[\n\\begin{aligned}\n(\\alpha I + C)y &= 1_n\\\\\ny &=(\\alpha I + C)^{-1}1_n\n\\end{aligned}\n\\] and consider the solution \\(x\\) to be the solution of a rank-1 update of the system in \\(y\\).\n\n\n\n\n\n\nSherman-Morrison formula\n\n\n\n\n\nSuppose that \\(A + uv^T\\) is invertible, where \\(A\\) is a \\(n\\times n\\) matrix, and \\(u\\) and \\(v\\) are column vectors of size \\(n\\). The matrix is invertible as long as \\(1 + v^T A^{-1}u \\neq 0\\).\nIf this is the case\n\\[\n(A + u v^T)^{-1} = A^{-1} - \\frac{1}{1 + v^T A^{-1}u} A^{-1} u v^T A^{-1}\n\\]\nThis formula is useful when we need to update the matrix inverse after a rank-1 perturbation.\n\n\n\nUsing the Sherman-Morrison formula, we obtain:\n\\[\n\\begin{aligned}\nx &= ((\\alpha I + C) + 1_n m^T)^{-1}1_n\\\\\n&= \\left((\\alpha I + C)^{-1}  - \\frac{1}{1 + m^T ((\\alpha I + C)^{-1}) 1_n} (\\alpha I + C)^{-1} 1_n m^T (\\alpha I + C)^{-1}\\right) 1_n\\\\\n&= y - \\frac{1}{1 + m^Ty} y m^T y\\\\\n&= \\frac{1}{1 + m^T y} y\n\\end{aligned}\n\\]\nThus, \\(x\\) and \\(y\\) are proportional to each other, with constant of proportionality \\(1 / (1 + m^T y)\\). Then \\(x &gt; 0_n\\) when either a) \\(y &gt; 0_n\\), and \\(1 + m^T y &gt; 0\\), or b) \\(y &lt; 0_n\\) and \\(1 + m^T y &lt; 0\\). Sum the equations in \\(y\\):\n\\[\n\\begin{aligned}\n1_n^T (\\alpha I + C) y &= 1_n^T 1_n\\\\\n\\alpha 1_n^T y &=n\\\\\n\\frac{1}{n} 1_n^T y &= \\frac{1}{\\alpha}\n\\end{aligned}\n\\]\nThis means that \\(y\\) cannot be all negative; then given that for \\(y&gt;0_n\\) and \\(m &gt; 0_n\\) we have \\(1 + m^Ty &gt; 0\\), we have that \\(x\\) is feasible if and only if \\(y\\) is feasible.\nThis means that any matrix that can be written as \\(B = C + 1m^T\\) with \\(m &gt; 0_n\\) belongs to the same class for feasibility—the exact value of \\(m\\) does not matter."
  },
  {
    "objectID": "ch2.html#a-sufficiently-large-alpha-guarantees-feasibility",
    "href": "ch2.html#a-sufficiently-large-alpha-guarantees-feasibility",
    "title": "GLV with random parameters",
    "section": "",
    "text": "We want to show that the system of equations\n\\[\n(\\alpha I + C)y = 1_n\n\\]\nhas a positive solution \\(y &gt; 0_n\\) for \\(\\alpha\\) large enough. To this end, we first divide both sides by \\(\\alpha &gt; 0\\):\n\\[\n\\left(I + \\frac{1}{\\alpha} C\\right)y = \\frac{1}{\\alpha} 1_n\n\\]\nWe have seen above that \\(\\alpha 1_n^T y/n = 1\\); we multiply the r.h.s. by this value, obtaining:\n\\[\n\\begin{aligned}\n\\left(I + \\frac{1}{\\alpha} C\\right)y &= \\frac{1}{\\alpha} 1_n \\frac{\\alpha}{n} 1_n^Ty\\\\\n\\left(\\frac{1}{\\alpha} C\\right)y  + y&= \\frac{1}{n} 1_n1_n^Ty\\\\\\\\\n\\left(\\frac{1}{n} 1_n1_n^T - \\frac{1}{\\alpha} C\\right)y &= y\n\\end{aligned}\n\\]\nThus, we have that \\(y\\) is a right eigenvector of matrix \\(\\frac{1}{n} 1_n1_n^T - \\frac{1}{\\alpha} C\\), associated with \\(\\lambda = 1\\).\n\n\n\n\n\n\nPerron-Frobenius theorem\n\n\n\n\n\nThe matrix \\(A\\) has all coefficients positive \\(A_{ij} &gt; 0\\, \\forall i,j\\).\nThen the matrix has a single positive real eigenvalue \\(\\rho\\) (spectral radius, or Perron root) such that \\(|\\lambda_i| &lt; \\rho\\) for all other eigenvalues. Moreover, the eigenvalue is associated with an eigenvectors that can be made all positive (Perron eigenvector).\n\n\n\nIf we choose \\(\\alpha = \\alpha_\\infty\\) such that \\(C_{ij} / \\alpha_\\infty &lt; 1/n\\), then the matrix \\(\\frac{1}{n} 1_n1_n^T - \\frac{1}{\\alpha_\\infty} C\\) has only positive coefficients; moreover all columns sum to unity and therefore the spectral radius is \\(\\rho = 1\\). Because of Perron-Frobenius theorem, \\(y &gt; 0_n\\)."
  },
  {
    "objectID": "ch2.html#classic-papers",
    "href": "ch2.html#classic-papers",
    "title": "GLV with random parameters",
    "section": "",
    "text": "The Lotka-Volterra predator-prey model was discovered independently by Alfred J. Lotka and Vito Volterra:\n\nAlfred J. Lotka, 1920. Analytical Note on Certain Rhythmic Relations in Organic Systems. PNAS 6 (7) 410-415\nVito Volterra, 1926. Fluctuations in the Abundance of a Species Considered Mathematically. Nature 118:558-60\n\nYou can read their exchange here.\nThe constant of motion was derived by Lotka in 1920:\n\nAlfred J. Lotka, 1920. Undamped oscillations derived from the law of mass action. Journal of the American Chemical Society 42:1595-1599\n\nVolterra considered many variations, including the competition between species. His results caught the eye of an experimentalist, who validated the principle of competitive exclusion using protozoans:\n\nG.F. Gause, 1934. Experimental Analysis of Vito Volterra’s Mathematical Theory of the Struggle for Existence. Science 79:16-17\n\nThe analysis of two-species competitive Lotka-Volterra inspired the so-called Modern Coexistence Theory:\n\nChesson, P. 2000. Mechanisms of Maintenance of Species Diversity. Annual Review of Ecology and Systematics 31:343-366\n\nOn functional responses:\n\nCrawford S. Holling, 1959. Some Characteristics of Simple Types of Predation and Parasitism. The Canadian Entomologist 91:385-398\n\nThe paper proposing the paradox of enrichment:\n\nRosenzweig, Michael, 1971. The Paradox of Enrichment. Science 171: 385–387\n\nMore on limit cycles in predator-prey systems:\n\nRobert M. May, 1972. Limit Cycles in Predator-Prey Communities Science 177:900-902\nMichael E. Gilpin, 1972. Enriched Predator-Prey Systems: Theoretical Stability Science 177:902-904\n\nThe Nicholson-Bailey model:\n\nA.J. Nicholson, V.A. Bailey, 1935. The Balance of Animal Populations. Part I. Proceedings of the Zoological Society of London. 105: 551–598\n\nand its spatial version:\n\nH.N. Comins, M.P. Hassell, R.M. May, 1992. The Spatial Dynamics of Host–Parasitoid Systems. Journal of Animal Ecology 61:735-748"
  }
]